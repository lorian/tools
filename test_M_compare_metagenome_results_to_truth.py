# test functions for M_compare_metagenome_results_to_truth.py

import M_compare_metagenome_results_to_truth as mc
import numpy as np

def test_xprs_input():
	# i100 express data
	test_species,test_abundance,test_counts,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_1.xprs',[3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0])
	print test_abundance
	#print test_counts
	assert test_species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert list(test_counts) == [234629, 213760.310134, 346706, 419783.882839, 383225.415617, 341431.949696, 527556.388114, 370053.769894, 268292.464229, 252582, 255483.375161, 348831.143398, 374089.490633, 434216.50783, 76330.818648, 25003.805463, 622392.549366, 433035.731062, 149229, 49913.184351, 68712.666882, 71288.170978, 74878.690298, 149806, 314425.789323, 397185.090472, 268466.222044, 198497.61575, 245521, 218375.770032, 161110.797489, 128066, 351901, 290454, 307753.334438, 344533.199106, 332812.370121, 219143.196593, 502007.164229, 113850, 230958.696804, 112050.986698, 129028.702287, 212194, 404085, 250388.424192, 177646.663253, 83196, 146165, 130504.949106, 167933.669028, 218923.755127, 109296.362415, 230036, 172045.6361, 114988.199135, 293558.49435, 270674.57774, 396721.935148, 673559.758298, 277188.899908, 144700.690202, 143058.036782, 550636.58284, 361127.967637, 167467.44071, 124540.462381, 491350.015719, 279650.202372, 396186.436754, 270906.582852, 27397.621216, 584827.354294, 403978.597309, 379098.76153, 68708.120797, 371096.721547, 295481.138781, 400436.648204, 271121, 231883.616698, 177537.385478, 168943.484771, 213001.300494, 178354.006181, 185813.844142, 156112.525783, 168763.97704, 114106.819046, 129895.51704, 204254.88706, 238582.627937, 182898, 120948, 144142, 216493.991574, 174017.797069, 45128.941671, 63178.82471, 295609.497603]
	assert list(test_abundance) == [0.96751926368479724, 1.1011219779976515, 0.95869732131068996, 0.83841496955525441, 1.0017894116673542, 0.8583584525432818, 1.3290421773731256, 0.86540366499758392, 0.88340720428155772, 0.83247683583437782, 0.83191124712788844, 0.89723948121373331, 0.76141822785592739, 1.4859935911212121, 1.1183751720318926, 0.92032966754102863, 1.185648826794417, 1.1322030673859678, 1.059858466234983, 0.89557776771907016, 0.88131025402889873, 0.8138127736517341, 0.812672833082554, 0.91525726062653445, 1.1391332634151285, 0.90748324568149441, 0.89704559638278059, 1.0670778464187851, 0.84331065281968998, 1.0542044048276304, 1.0943790944322926, 0.92036398990281676, 0.90545640067844535, 0.89542112630197268, 1.1547736715768302, 0.92708679123521442, 0.94038926234872233, 0.71064450082584485, 1.6124959581219982, 0.84517501430150743, 0.9116577942168681, 0.89250336041846245, 0.90819415672832127, 0.9172727865528234, 0.9295265999742478, 1.0764620913158061, 0.90654449257343472, 0.91181480076547394, 1.1513805044694017, 0.85557907150144974, 0.90624691039410044, 1.3030276527951692, 0.8661788391898867, 0.77226007773442429, 0.85995809368151954, 0.90965869920845654, 1.0878903423967703, 1.0485214980311153, 0.99868944516115943, 1.9244880524347892, 1.0543924475544491, 0.98037481383204095, 0.91505096132429642, 0.85891965967167061, 1.0428283675523653, 1.0248701045754314, 0.93675656897179305, 1.4130461578498827, 1.038612559156544, 1.8521416256262624, 0.86365030349431571, 0.14150518252254451, 0.98711222042477387, 1.2584268390458555, 1.1848203434018898, 0.87606696556848007, 1.1511899058220243, 0.92056152604885344, 0.9467922084797743, 0.97285712120588763, 1.1156545771629109, 0.86469165855623176, 0.82888978389599655, 1.0683601882762357, 0.89429213967804411, 0.91254360325621187, 1.0046593453232657, 1.1297168869453695, 0.84332306729097517, 0.99159895639981754, 1.1630300252444479, 1.3084954971332452, 0.85790678486740857, 0.87212281501489752, 1.0227819174789734, 1.3120551642084974, 0.82964305019779638, 0.92059219709555795, 1.3447698519653315, 0.89476060340330277]
	assert np.sum(test_abundance) == 100
'''
def test_gasic_input():
	# i100 gasic data
	test_species,test_abundance,test_counts,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_2.txt',[3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0])
	assert test_species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', 'sodalis_glossinidius_str_morsitans', 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert list(test_counts) == [235101.540521, 201447.602453, 344850.566872, 420147.964386, 198186.858763, 270947.151434, 476296.849749, 396217.495491, 256487.492585, 251937.311265, 242987.712799, 511843.990812, 374648.024411, 414538.143227, 68405.8645448, 12539.1927809, 608115.705508, 401128.660273, 145610.36132, 40792.9590834, 63701.6981651, 65203.6761317, 72664.0815683, 146089.757059, 289726.573577, 390561.527088, 256959.565176, 192822.411437, 240581.19332, 213614.285035, 154052.810374, 124392.658782, 351371.544771, 290160.234145, 301948.529199, 251823.208095, 639222.0377, 355533.938376, 138822.553958, 106135.938603, 222707.087134, 107321.397943, 126418.232998, 213920.337069, 401836.832957, 240672.496088, 168732.926303, 84154.9362148, 142293.854617, 126258.698677, 151009.411292, 214271.824875, 103791.988364, 226860.764588, 163919.799824, 114294.949741, 256248.203838, 99815.3053165, 369181.714533, 652328.484917, 433917.417358, 170536.848988, 106053.296603, 552560.211893, 358203.411231, 163709.967208, 118229.637846, 481556.216643, 263429.906693, 396077.203924, 265355.637329, 10121.9053372, 570581.430956, 388630.317742, 354175.721541, 63741.5644336, 349374.628711, 292131.872235, 393488.221169, 273284.577832, 151965.660579, 102184.558357, 54516.1958614, 73125.3557114, 644006.276341, 103810.244575, 146872.219436, 165579.41592, 181799.55293, 54128.4385649, 273797.580414, 169590.558817, 179181.889629, 115850.193212, 141469.952191, 205358.925885, 168476.335941, 38157.0345743, 55066.8181038, 290932.707122]
	assert list(test_abundance) == [1.0446256785349561, 0.95029908030784549, 1.0810777617963336, 0.91855102638203967, 0.5859123949121201, 0.77073893480132383, 1.3562690167928007, 1.0478873536588382, 0.92096180983163811, 0.92647720430906366, 0.89098026968778166, 1.4887779715406073, 0.91996813774730457, 1.1998437451279955, 1.0711439061789487, 0.45871649895635092, 1.0831112591496852, 0.88048261885453705, 1.071836787728389, 0.79631422619758552, 0.94760513695271509, 0.85295397561483666, 0.9127842767489549, 0.95466788273243075, 0.9423899852617067, 1.0058359217995692, 0.9668815666478866, 1.1696084268730349, 0.96736852106359572, 1.0253581634019873, 1.0048450417561359, 0.94571761862838288, 0.99443920299096511, 1.0114711041541022, 1.1470982970981805, 0.70786908370928048, 1.881852226420341, 1.1842182118392519, 0.46172614444412152, 0.8666318238131272, 0.90234673077952265, 0.90622733454071924, 0.97056968408852118, 1.0397927146501911, 0.91518083083151136, 1.0038537911389345, 0.91837589897577065, 1.0022918172706241, 1.1841872352424092, 0.91433562035442406, 0.89813275969436823, 1.399782151267619, 0.93307882860750135, 0.90444852731547121, 0.90016460916829655, 0.99638674494404011, 0.81991355513144681, 0.35497098852494297, 0.85662584487085891, 1.6667049239295808, 1.5155977049420677, 1.223553425713592, 0.72124316777210717, 0.9425939084736441, 1.0633553370418753, 1.0493864773833996, 0.97981671445555152, 1.2887838018030531, 0.89131044133614423, 1.9737813076631423, 0.89936594574742434, 0.046489774469276511, 0.9087782304627553, 1.0908751763564415, 0.99950403290876555, 0.88621468009369531, 1.1111923422380741, 0.9407038311644883, 0.90872025572174786, 0.98387287970889137, 0.79962342227637417, 0.54403884970482386, 0.29251113129211603, 0.400665929584887, 3.5274926405811491, 0.55724831286156784, 1.0506713777384038, 1.255179408897281, 1.4782735737440718, 0.45497107222840516, 1.5692903985865541, 0.9371858349391502, 0.94306991958957664, 0.93477844117215181, 0.99500698397793508, 1.0906459135932876, 0.91572700283290576, 0.78442922111847591, 1.2105040419426416, 0.9308782021085954]
	assert np.sum(test_abundance) == 100
'''
def test_abundance_calc():
	# simLC original counts, should calculate correct abundances
	test_species,test_abundance,test_counts,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_3.txt',[2319663.0, 3275944.0, 4929566.0, 6365727.0, 5013479.0, 4698945.0, 5365318.0, 4087024.0, 2375792.0, 8264687.0, 4367044.0, 7484988.0, 7279118.0, 7537985.0, 3587082.0, 7305582.0, 9731140.0, 2970275.0, 2763181.0, 3133902.0, 1966858.0, 5258541.0, 3696649.0, 6000632.0, 3843301.0, 6238478.0, 4433218.0, 4501104.0, 2467205.0, 5279134.0, 3730232.0, 1315030.0, 1005936.0, 2698137.0, 3034136.0, 1947953.0, 5433628.0, 8982042.0, 3997420.0, 2007700.0, 4317977.0, 4761183.0, 2291220.0, 2895264.0, 1856951.0, 1894360.0, 2438589.0, 2038396.0, 4719581.0, 4326849.0, 4412446.0, 2575032.0, 4837408.0, 3544738.0, 2971517.0, 2628784.0, 4406967.0, 3402093.0, 3481691.0, 2661057.0, 3184243.0, 4985871.0, 3561584.0, 1780517.0, 4582380.0, 1832387.0, 3665893.0, 4008000.0, 2364842.0, 3018238.0, 5200264.0, 1709204.0, 1842899.0, 2512923.0, 2736403.0, 5187005.0, 6438405.0, 5959964.0, 6093698.0, 2650701.0, 3059876.0, 4131626.0, 4712337.0, 5505494.0, 5513844.0, 4892717.0, 5331656.0, 4352825.0, 3225748.0, 5057531.0, 4306142.0, 5127376.0, 4845257.0, 4659220.0, 4972204.0, 4792610.0, 4602594.0, 4708380.0, 3200938.0, 3345170.0, 2143334.0, 1856368.0, 2695903.0, 4990251.0, 2936195.0, 2362816.0, 3642249.0, 2909809.0, 2427734.0, 2201561.0, 7750108.0, 5115560.0, 2622359.0])
	assert test_species == ['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon']
	assert list(test_counts) == [252.0, 373.0, 489.0, 855.0, 584.0, 570.0, 650.0, 520.0, 288.0, 9277.0, 542.0, 955.0, 879.0, 956.0, 1074.0, 992.0, 1149.0, 367.0, 381.0, 359.0, 199.0, 679.0, 454.0, 737.0, 461.0, 812.0, 5168.0, 537.0, 415.0, 769.0, 484.0, 196.0, 150.0, 359.0, 377.0, 238.0, 645.0, 1109.0, 515.0, 232.0, 543.0, 566.0, 177.0, 362.0, 195.0, 244.0, 301.0, 235.0, 504.0, 547.0, 567.0, 268.0, 545.0, 429.0, 365.0, 674.0, 630.0, 427.0, 409.0, 314.0, 378.0, 636.0, 520.0, 182.0, 585.0, 217.0, 489.0, 508.0, 250.0, 402.0, 733.0, 183.0, 253.0, 282.0, 483.0, 588.0, 730.0, 675.0, 746.0, 327.0, 422.0, 514.0, 599.0, 636.0, 699.0, 575.0, 28861.0, 559.0, 409.0, 582.0, 536.0, 621.0, 551.0, 565.0, 664.0, 568.0, 524.0, 533.0, 469.0, 438.0, 263.0, 178.0, 316.0, 606.0, 314.0, 315.0, 434.0, 395.0, 274.0, 277.0, 977.0, 2836.0, 601.0]
	assert list(test_abundance) == [0.4914472977119464, 0.51507879203630236, 0.44874691859582572, 0.60760230264843462, 0.52695672685272965, 0.5487516003743127, 0.54804875440765999, 0.57556908829524811, 0.54838476141364312, 5.0778802152599649, 0.56145250620163922, 0.5771830503711517, 0.54627512023508185, 0.57372520428966989, 1.3544540701120431, 0.61426837727555761, 0.53414308926557041, 0.55894710386835, 0.62375917614755771, 0.51821543339088172, 0.45770048827841431, 0.58412502925336929, 0.55558299276038836, 0.55561223427184514, 0.5426225430135988, 0.58881475890645874, 5.2735700955775089, 0.53970512731161602, 0.76092905283129564, 0.6589689626736468, 0.58696313295922142, 0.67425118232762804, 0.67456253071788885, 0.60191027480611659, 0.56209226982659255, 0.55271313927408161, 0.53699608360583206, 0.55854448828403414, 0.58281236057026531, 0.52274570325863223, 0.56888019012580038, 0.53777779092231248, 0.34946829462132473, 0.565616025969499, 0.47504578961442662, 0.58267799528303721, 0.558379147132404, 0.52153157831469477, 0.48309038999537735, 0.57189578134638841, 0.58130620842563741, 0.47081844597209332, 0.50966532762397476, 0.54748781403721747, 0.55566872156227287, 1.1598619454185031, 0.64669880268696522, 0.56778380323602429, 0.53141570990493625, 0.53379779650134584, 0.53701560133085946, 0.57705523302487693, 0.66048271710587148, 0.46240930984218592, 0.57751872655932013, 0.53572737366196832, 0.60343483907324913, 0.57337308852514468, 0.47823260771771803, 0.60252334204678926, 0.63764636558050225, 0.48434909780124596, 0.62104102893234425, 0.50765799816883872, 0.798487972407113, 0.51281647056228052, 0.51291555982904469, 0.51234374948423111, 0.55380797614144073, 0.55806953704039108, 0.62389273662483302, 0.56278617865334102, 0.57503170027417805, 0.52259124280890612, 0.57348756692700642, 0.53164171971337859, 24.487844560982609, 0.58095421440900064, 0.57358023454858464, 0.52057791193625769, 0.56308991415908316, 0.54789550802339315, 0.51444160805646544, 0.54857566238358935, 0.6041161509191938, 0.53613918770124669, 0.51502691534921485, 0.51210263285011359, 0.66282195656233267, 0.59232112657612979, 0.55509485382978285, 0.43376772505681693, 0.53025421145214979, 0.54935304956743258, 0.48377793810168668, 0.60308976288906269, 0.53904050768760348, 0.61409267730995609, 0.5105646804486903, 0.56918094415845166, 0.57027996600866715, 2.5079238732299789, 1.0367728880092018]
	assert [round(i,2) for i in test_abundance] == [0.49,0.52,0.45,0.61,0.53,0.55,0.55,0.58,0.55,5.08,0.56,0.58,0.55,0.57,1.35,0.61,0.53,0.56,0.62,0.52,0.46,0.58,0.56,0.56,0.54,0.59,5.27,0.54,0.76,0.66,0.59,0.67,0.67,0.6,0.56,0.55,0.54,0.56,0.58,0.52,0.57,0.54,0.35,0.57,0.48,0.58,0.56,0.52,0.48,0.57,0.58,0.47,0.51,0.55,0.56,1.16,0.65,0.57,0.53,0.53,0.54,0.58,0.66,0.46,0.58,0.54,0.6,0.57,0.48,0.6,0.64,0.48,0.62,0.51,0.8,0.51,0.51,0.51,0.55,0.56,0.62,0.56,0.58,0.52,0.57,0.53,24.49,0.58,0.57,0.52,0.56,0.55,0.51,0.55,0.6,0.54,0.52,0.51,0.66,0.59,0.56,0.43,0.53,0.55,0.48,0.6,0.54,0.61,0.51,0.57,0.57,2.51,1.04]
	assert np.sum(test_abundance) == 100

def test_i100_truth():
	test_species,test_abundance,test_counts,test_size,temp1,temp2,temp3,temp4 = mc.dataset_truth('i100')
	assert list(test_species) == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert list(test_abundance) == [0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997]
	assert list(test_counts) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
	assert list(test_size) == [3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0]
	assert np.sum(test_abundance) == 100.00000000030001

def test_simLC_truth():
	test_species,test_abundance,test_counts,test_size,temp1,temp2,temp3,temp4 = mc.dataset_truth('simLC')
	assert list(test_species) == ['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1,alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_btai1,bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383,burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb40,burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300,deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_338890,thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon']
	assert list(test_abundance) == [0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]
	assert list(test_counts) == [252, 373, 489, 855, 584, 570, 650, 520, 288, 9277, 542, 955, 879, 956, 1074, 992, 1149, 367, 381, 359, 199, 679, 454, 737, 461, 812, 5168, 537, 415, 769, 484, 196, 150, 359, 377, 238, 645, 1109, 515, 232, 543, 566, 177, 362, 195, 244, 301, 235, 504, 547, 567, 268, 545, 429, 365, 674, 630, 427, 409, 314, 378, 636, 520, 182, 585, 217, 489, 508, 250, 402, 733, 183, 253, 282, 483, 588, 730, 675, 746, 327, 422, 514, 599, 636, 699, 575, 28861, 559, 409, 582, 536, 621, 551, 565, 664, 568, 524, 533, 469, 438, 263, 178, 316, 606, 314, 315, 434, 395, 274, 277, 977, 2836, 601]
	assert list(test_size) == [2319663.0, 3275944.0, 4929566.0, 6365727.0, 5013479.0, 4698945.0, 5365318.0, 4087024.0, 2375792.0, 8264687.0, 4367044.0, 7484988.0, 7279118.0, 7537985.0, 3587082.0, 7305582.0, 9731140.0, 2970275.0, 2763181.0, 3133902.0, 1966858.0, 5258541.0, 3696649.0, 6000632.0, 3843301.0, 6238478.0, 4433218.0, 4501104.0, 2467205.0, 5279134.0, 3730232.0, 1315030.0, 1005936.0, 2698137.0, 3034136.0, 1947953.0, 5433628.0, 8982042.0, 3997420.0, 2007700.0, 4317977.0, 4761183.0, 2291220.0, 2895264.0, 1856951.0, 1894360.0, 2438589.0, 2038396.0, 4719581.0, 4326849.0, 4412446.0, 2575032.0, 4837408.0, 3544738.0, 2971517.0, 2628784.0, 4406967.0, 3402093.0, 3481691.0, 2661057.0, 3184243.0, 4985871.0, 3561584.0, 1780517.0, 4582380.0, 1832387.0, 3665893.0, 4008000.0, 2364842.0, 3018238.0, 5200264.0, 1709204.0, 1842899.0, 2512923.0, 2736403.0, 5187005.0, 6438405.0, 5959964.0, 6093698.0, 2650701.0, 3059876.0, 4131626.0, 4712337.0, 5505494.0, 5513844.0, 4892717.0, 5331656.0, 4352825.0, 3225748.0, 5057531.0, 4306142.0, 5127376.0, 4845257.0, 4659220.0, 4972204.0, 4792610.0, 4602594.0, 4708380.0, 3200938.0, 3345170.0, 2143334.0, 1856368.0, 2695903.0, 4990251.0, 2936195.0, 2362816.0, 3642249.0, 2909809.0, 2427734.0, 2201561.0, 7750108.0, 5115560.0, 2622359.0]
	assert np.sum(test_abundance) == 99.98
	assert np.sum(test_counts) == 100628

def test_calc_error_simLC_truth():
	# simLC original data, should be no error
	test_diff,test_ab = mc.calc_error(['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1,alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_btai1,bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383,burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb40,burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300,deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_338890,thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon'],np.array([0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]),['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon'],np.array([0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]))
	assert np.mean(test_diff) == 0


def test_calc_error_i100_truth():
	# i100 original data, should be no error
	test_diff,test_ab = mc.calc_error(['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92'],np.array([0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997]),['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92'],np.array([0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997]))
	assert np.mean(test_diff) == 0

def test_calc_error_simLC_error():
	# last two entries have error
	test_diff,test_ab = mc.calc_error(['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1,alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_btai1,bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383,burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb40,burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300,deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_338890,thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon'],np.array([0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]),['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon'],np.array([0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 3.01, 0.54]))
	assert list(test_diff) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.920318725099602, 48.076923076923073]
	assert np.mean(test_diff) == 0.60174550267276705

def test_calc_error_i100_extra():
	# has extra species in it
	abund = [0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997,0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]
	abund = [a/2 for a in abund]
	test_diff,test_ab = mc.calc_error(['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92'],np.array([0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997]),['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92','actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon'],np.array(abund))
	assert np.mean(test_diff) == 50

def test_collapse_strains():
	test_species = ['acinetobacter_baumannii_sdf', 'acinetobacter_baumannii_sda', 'acinetobacter_baumannii_sdb', 'acinetobacter_baumannii_sdc', 'acinetobacter_c_1', 'acinetobacter_c_2', 'acinetobacter_c_3', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_200', 'bacillus_cereus_atcc']
	test_abundance = [1,1,1,1,1,1,1,1,1,1]
	test_species_alone,test_species_ab,test_genus_alone,test_genus_ab = mc.collapse_strains(test_species,test_abundance)
	assert list(test_species_alone) == ['acinetobacter_baumannii', 'acinetobacter_c', 'bacillus_cereus']
	assert list(test_species_ab) == [4,3,3]
	assert list(test_genus_alone) == ['acinetobacter','bacillus']
	assert list(test_genus_ab) == [7,3]

