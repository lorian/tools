# test functions for M_compare_metagenome_results_to_truth.py

import M_compare_metagenome_results_to_truth as mc
import numpy as np

def round_list(lst):
	return [round(x,5) for x in lst]

def test_i100_truth():
	i100,temp1,temp2,temp3,temp4 = mc.dataset_truth('i100')
	assert i100.species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert list(i100.abundance) == [0.9918569894, 0.95341031890000005, 1.0337468099, 0.87012337539999995, 1.0629349921, 0.90775766609999997, 1.4619387586000001, 0.91474326009999996, 0.90289116169999994, 0.88473675959999998, 0.87650906279999996, 0.95059189619999995, 0.86616008050000004, 1.1977086557000001, 1.1270363888999999, 0.86520271250000003, 1.0474017421999999, 0.89539444050000006, 1.0403648471, 0.91293948049999996, 0.95932516879999996, 0.87114935819999995, 0.88109836860000001, 0.92648537360000005, 0.96243268979999996, 0.96564848209999998, 0.94785945930000004, 1.1580488951000001, 0.93303811390000002, 1.0275058892, 1.0008453082, 0.91847494770000004, 0.94013431439999995, 0.95631963669999998, 1.1018606017000001, 0.90610218190000003, 0.92440945490000004, 0.98361520160000004, 1.2861538912999999, 0.87992403890000004, 0.88229156190000002, 0.89258733160000003, 0.93533927130000005, 0.9724329129, 0.86713050219999999, 0.97974135920000005, 0.91117493810000005, 0.92861382319999997, 1.1765523476999999, 0.90133327590000001, 0.93770362279999997, 1.3855635178000001, 0.92040630329999995, 0.86332590129999998, 0.88598993339999998, 0.94520846920000001, 0.88726431240000003, 0.89980567069999995, 0.87762988239999995, 1.7694735192, 0.90448041560000003, 0.98764970490000004, 0.93079721319999997, 0.89830731149999998, 1.0160158194, 1.0107078939, 0.96897939509999997, 1.2512067245, 0.89122133020000005, 2.2276838860999999, 0.86911180919999997, 0.88856054689999997, 0.88350416809999999, 1.0715558086000001, 1.0056581462, 0.89397809709999998, 1.1138419429999999, 0.89683721400000005, 0.87431760150000004, 0.94263472130000003, 1.1416733976, 0.87540511909999996, 0.86425808650000002, 1.0909113026999999, 0.87876804559999999, 0.97601723360000003, 1.0549061129999999, 1.2222455073, 0.87324607740000004, 1.0216060125999999, 0.86811430030000003, 1.5752103822000001, 0.90944813820000003, 0.92238380630000005, 0.99625052030000005, 1.0808489742, 0.88987931620000005, 0.87219013000000001, 1.3295506979, 0.91658785789999997]
	assert list(i100.counts) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
	assert list(i100.size) == [3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0]
	assert round(np.sum(i100.abundance),5) == 100

def test_i400_truth():
	i400,temp1,temp2,temp3,temp4 = mc.dataset_truth('i400')
	assert i400.species == ['acaryochloris_marina_mbic11017', 'acholeplasma_laidlawii_pg8a', 'acidiphilium_cryptum_jf5', 'acidothermus_cellulolyticus_11b', 'acidovorax_sp_js42', 'acinetobacter_baumannii_atcc_17978', 'acinetobacter_sp_adp1', 'actinobacillus_pleuropneumoniae_l20', 'actinobacillus_succinogenes_130z', 'aeromonas_hydrophila_subsp_hydrophila_atcc_7966', 'aeromonas_salmonicida_subsp_salmonicida_a449', 'alcanivorax_borkumensis_sk2', 'alkalilimnicola_ehrlichii_mlhe1?alkalilimnicola_ehrlichei_mlhe1', 'alkaliphilus_oremlandii_ohilas', 'anaeromyxobacter_dehalogenans_2cpc', 'anaeromyxobacter_sp_fw1095', 'anaplasma_marginale_str_st_maries', 'anaplasma_phagocytophilum_hz', 'aquifex_aeolicus_vf5', 'archaeoglobus_fulgidus_dsm_4304', 'arcobacter_butzleri_rm4018', 'arthrobacter_aurescens_tc1', 'arthrobacter_sp_fb24', 'aster_yellows_witchesbroom_phytoplasma_aywb', 'azoarcus_aromaticum_ebn1?azoarcus_sp_ebn1', 'azorhizobium_caulinodans_ors_571', 'bacillus_amyloliquefaciens_subsp_plantarum_str_fzb42?bacillus_amyloliquefaciens_fzb42', 'bacillus_anthracis_str_ames_ancestor', 'bacillus_cereus_e33l', 'bacillus_halodurans_c125', 'bacillus_licheniformis_atcc_14580', 'bacillus_pumilus_safr032', 'bacillus_thuringiensis_str_al_hakam', 'bacillus_weihenstephanensis_kbab4', 'bacteroides_fragilis_ych46', 'bacteroides_vulgatus_atcc_8482', 'bartonella_bacilliformis_kc583', 'bartonella_henselae_strain_houston1?bartonella_henselae_str_houston1', 'bartonella_quintana_str_toulouse', 'bartonella_tribocorum_cip_105476', 'bifidobacterium_adolescentis_atcc_15703', 'bifidobacterium_longum_djo10a', 'bordetella_avium_197n', 'bordetella_parapertussis_strain_12822?bordetella_parapertussis_12822', 'bordetella_pertussis_tohama_i', 'bordetella_petrii_strain_dsm_12804?bordetella_petrii_dsm_12804', 'borrelia_afzelii_pko', 'borrelia_burgdorferi_b31', 'borrelia_garinii_pbi', 'bradyrhizobium_japonicum_usda_110', 'bradyrhizobium_sp_btai1', 'brucella_canis_atcc_23365', 'brucella_melitensis_bv_1_str_16m?brucella_melitensis_16m', 'brucella_ovis_atcc_25840', 'brucella_suis_1330', 'buchnera_aphidicola_str_aps_acyrthosiphon_pisum', 'burkholderia_cenocepacia_mc03', 'burkholderia_mallei_nctc_10247', 'burkholderia_multivorans_atcc_17616', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_1710b', 'burkholderia_thailandensis_e264', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_saccharolyticus_dsm_8903', 'caldivirga_maquilingensis_ic167', 'campylobacter_curvus_52592', 'campylobacter_hominis_atcc_baa381', 'campylobacter_jejuni_rm1221', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'candidatus_carsonella_ruddii_pv', 'candidatus_desulforudis_audaxviator_mp104c', 'candidatus_korarchaeum_cryptofilum_opf8', 'candidatus_koribacter_versatilis_ellin345?acidobacteria_bacterium_ellin345', 'candidatus_pelagibacter_ubique_htcc1062', 'candidatus_ruthia_magnifica_str_cm_calyptogena_magnifica', 'candidatus_vesicomyosocius_okutanii_ha', 'carboxydothermus_hydrogenoformans_z2901', 'caulobacter_crescentus_cb15', 'chlamydia_muridarum_nigg', 'chlamydia_trachomatis_duw3cx', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_ar39', 'chlorobium_luteolum_dsm_273?pelodictyon_luteolum_dsm_273', 'chlorobium_tepidum_tls', 'chloroflexus_aurantiacus_j10fl', 'chromobacterium_violaceum_atcc_12472', 'chromohalobacter_salexigens_dsm_3043', 'citrobacter_koseri_atcc_baa895', 'clostridium_acetobutylicum_atcc_824', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_a3_str_loch_maree', 'clostridium_difficile_630', 'clostridium_kluyveri_dsm_555', 'clostridium_novyi_nt', 'clostridium_perfringens_atcc_13124', 'clostridium_phytofermentans_isdg', 'clostridium_tetani_e88', 'clostridium_thermocellum_atcc_27405', 'colwellia_psychrerythraea_34h', 'corynebacterium_diphtheriae_nctc_13129', 'corynebacterium_efficiens_ys314', 'corynebacterium_jeikeium_k411', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_dugway_5j108111', 'cupriavidus_taiwanensis', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'dehalococcoides_ethenogenes_195', 'dehalococcoides_sp_cbdb1', 'deinococcus_radiodurans_r1', 'delftia_acidovorans_sph1', 'desulfococcus_oleovorans_hxd3', 'desulfotalea_psychrophila_lsv54', 'desulfotomaculum_reducens_mi1', 'desulfovibrio_alaskensis_g20?desulfovibrio_desulfuricans_subsp_desulfuricans_str_g20', 'desulfovibrio_vulgaris_subsp_vulgaris_str_hildenborough', 'dichelobacter_nodosus_vcs1703a', 'dinoroseobacter_shibae_dfl_12', 'ehrlichia_chaffeensis_str_arkansas', 'ehrlichia_ruminantium_str_welgevonden', 'enterobacter_sp_638', 'erwinia_tasmaniensis', 'erythrobacter_litoralis_htcc2594', 'exiguobacterium_sibiricum_25515', 'finegoldia_magna_atcc_29328', 'flavobacterium_johnsoniae_uw101', 'flavobacterium_psychrophilum_jip0286', 'francisella_philomiragia_subsp_philomiragia_atcc_25017', 'frankia_alni_str_acn14a?frankia_alni_acn14a', 'fusobacterium_nucleatum_subsp_nucleatum_atcc_25586', 'geobacillus_kaustophilus_hta426', 'geobacillus_thermodenitrificans_ng802', 'geobacter_lovleyi_sz', 'geobacter_sulfurreducens_pca', 'geobacter_uraniireducens_rf4', 'gloeobacter_violaceus_pcc_7421', 'gluconacetobacter_diazotrophicus_pal_5', 'gluconobacter_oxydans_621h', 'gramella_forsetii_kt0803', 'granulibacter_bethesdensis_cgdnih1', 'haemophilus_ducreyi_strain_35000hp?haemophilus_ducreyi_35000hp', 'haemophilus_influenzae_pittgg', 'haemophilus_somnus_2336', 'haloarcula_marismortui_atcc_43049', 'halobacterium_salinarum_r1', 'halobacterium_sp_nrc1', 'halorhodospira_halophila_sl1', 'helicobacter_acinonychis_str_sheeba', 'helicobacter_hepaticus_atcc_51449', 'helicobacter_pylori_26695', 'heliobacterium_modesticaldum_ice1', 'herminiimonas_arsenicoxydans', 'hyperthermus_butylicus_dsm_5456', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'jannaschia_sp_ccs1', 'janthinobacterium_sp_marseille', 'kineococcus_radiotolerans_srs30216', 'klebsiella_pneumoniae_subsp_pneumoniae_mgh_78578', 'lactobacillus_acidophilus_ncfm', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_fermentum_ifo_3956', 'lactobacillus_gasseri_atcc_33323', 'lactobacillus_helveticus_dpc_4571', 'lactobacillus_plantarum_wcfs1', 'lactobacillus_reuteri_dsm_20016?lactobacillus_reuteri_f275', 'lactobacillus_sakei_strain_23k?lactobacillus_sakei_subsp_sakei_23k', 'lactococcus_lactis_subsp_cremoris_sk11', 'lawsonia_intracellularis_phemn100', 'legionella_pneumophila_str_paris', 'leifsonia_xyli_subsp_xyli_str_ctcb07', 'leptospira_biflexa_serovar_patoc_strain_patoc_1_paris', 'leptospira_borgpetersenii_serovar_hardjobovis_l550', 'leptospira_interrogans_serovar_lai_str_56601', 'leptothrix_cholodnii_sp6', 'leuconostoc_citreum_km20', 'leuconostoc_mesenteroides_subsp_mesenteroides_atcc_8293', 'listeria_innocua_clip11262', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'magnetospirillum_magneticum_amb1', 'mannheimia_succiniciproducens_mbel55e', 'maricaulis_maris_mcs10', 'marinobacter_aquaeolei_vt8', 'mesoplasma_florum_l1', 'mesorhizobium_loti_maff303099', 'chelativorans_sp_bnc1?mesorhizobium_sp_bnc1', 'methanobrevibacter_smithii_atcc_35061', 'methanocaldococcus_jannaschii_dsm_2661', 'methanocella_arvoryzae_mre50?uncultured_methanogenic_archaeon_rci', 'methanococcoides_burtonii_dsm_6242', 'methanococcus_aeolicus_nankai3', 'methanococcus_maripaludis_c5', 'methanococcus_vannielii_sb', 'methanocorpusculum_labreanum_z', 'methanoculleus_marisnigri_jr1', 'methanopyrus_kandleri_av19', 'methanosaeta_thermophila_pt', 'methanosarcina_barkeri_str_fusaro', 'methanosarcina_mazei_go1', 'methanosphaera_stadtmanae_dsm_3091', 'methanospirillum_hungatei_jf1', 'methanothermobacter_thermautotrophicus_str_delta_h', 'methylobacillus_flagellatus_kt', 'methylobacterium_extorquens_pa1', 'methylobacterium_radiotolerans_jcm_2831', 'methylobacterium_sp_446', 'methylococcus_capsulatus_str_bath', 'microcystis_aeruginosa_nies843', 'moorella_thermoacetica_atcc_39073', 'mycobacterium_bovis_bcg_pasteur_1173p2?mycobacterium_bovis_bcg_str_pasteur_1173p2', 'mycobacterium_gilvum_pyrgck', 'mycobacterium_leprae_tn', 'mycobacterium_marinum_m', 'mycobacterium_smegmatis_str_mc2_155', 'mycobacterium_sp_kms', 'mycobacterium_ulcerans_agy99', 'mycobacterium_vanbaalenii_pyr1', 'mycoplasma_agalactiae_pg2', 'mycoplasma_capricolum_subsp_capricolum_atcc_27343', 'mycoplasma_gallisepticum_str_rlow?mycoplasma_gallisepticum_r', 'mycoplasma_genitalium_g37', 'mycoplasma_mobile_163k', 'mycoplasma_mycoides_subsp_mycoides_sc_str_pg1', 'mycoplasma_penetrans_hf2', 'mycoplasma_pulmonis_uab_ctip', 'mycoplasma_synoviae_53', 'myxococcus_xanthus_dk_1622', 'nanoarchaeum_equitans_kin4m', 'natronomonas_pharaonis_dsm_2160', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'neorickettsia_sennetsu_strain_miyayama?neorickettsia_sennetsu_str_miyayama', 'nitrobacter_hamburgensis_x14', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_atcc_19707', 'nitrosomonas_europaea_atcc_19718', 'nitrosomonas_eutropha_c91', 'nitrosopumilus_maritimus_scm1', 'nitrosospira_multiformis_atcc_25196', 'nocardia_farcinica_ifm_10152', 'nocardioides_sp_js614', 'nostoc_punctiforme_pcc_73102', 'nostoc_sp_pcc_7120', 'novosphingobium_aromaticivorans_dsm_12444', 'oceanobacillus_iheyensis_hte831', 'ochrobactrum_anthropi_atcc_49188', 'oenococcus_oeni_psu1', 'onion_yellows_phytoplasma_oym', 'opitutus_terrae_pb901', 'orientia_tsutsugamushi_str_boryong', 'parabacteroides_distasonis_atcc_8503', 'parachlamydiarelated_symbiont_uwe25?candidatus_protochlamydia_amoebophila_uwe25', 'paracoccus_denitrificans_pd1222', 'parvibaculum_lavamentivorans_ds1', 'pasteurella_multocida_subsp_multocida_str_pm70', 'pelobacter_carbinolicus_dsm_2380', 'petrotoga_mobilis_sj95', 'photobacterium_profundum_ss9', 'photorhabdus_luminescens_subsp_laumondii_tto1', 'picrophilus_torridus_dsm_9790', 'polaromonas_naphthalenivorans_cj2', 'polaromonas_sp_js666', 'polynucleobacter_necessarius_subsp_asymbioticus_qlwp1dmwa1?polynucleobacter_sp_qlwp1dmwa1', 'polynucleobacter_necessarius_subsp_necessarius_stir1?polynucleobacter_necessarius_stir1', 'porphyromonas_gingivalis_atcc_33277', 'propionibacterium_acnes_kpa171202', 'pseudoalteromonas_atlantica_t6c', 'pseudoalteromonas_haloplanktis_str_tac125?pseudoalteromonas_haloplanktis_tac125', 'pseudomonas_aeruginosa_pa7', 'pseudomonas_protegens_pf5?pseudomonas_fluorescens_pf5', 'pseudomonas_putida_kt2440', 'pseudomonas_stutzeri_a1501', 'pseudomonas_syringae_pv_tomato_str_dc3000', 'psychrobacter_arcticus_2734', 'psychrobacter_cryohalolentis_k5', 'psychrobacter_sp_prwf1', 'psychromonas_ingrahamii_37', 'pyrobaculum_aerophilum_str_im2', 'pyrobaculum_arsenaticum_dsm_13514', 'pyrobaculum_calidifontis_jcm_11548', 'pyrobaculum_islandicum_dsm_4184', 'pyrococcus_abyssi_ge5', 'pyrococcus_furiosus_dsm_3638', 'pyrococcus_horikoshii_ot3', 'ralstonia_eutropha_jmp134', 'cupriavidus_metallidurans_ch34?ralstonia_metallidurans_ch34', 'ralstonia_solanacearum_gmi1000', 'renibacterium_salmoninarum_atcc_33209', 'rhizobium_etli_cfn_42', 'rhizobium_leguminosarum_bv_viciae_chromosome_complete_genome_strain_3841?rhizobium_leguminosarum_bv_viciae_3841', 'rhodobacter_sphaeroides_241', 'rhodococcus_jostii_rha1?rhodococcus_sp_rha1', 'rhodoferax_ferrireducens_t118', 'rhodopirellula_baltica_sh_1', 'rhodopseudomonas_palustris_bisa53', 'rhodospirillum_rubrum_atcc_11170', 'rickettsia_akari_str_hartford', 'rickettsia_bellii_rml369c', 'rickettsia_canadensis_str_mckiel', 'rickettsia_felis_urrwxcal2', 'rickettsia_massiliae_mtu5', 'rickettsia_prowazekii_str_madrid_e', 'rickettsia_rickettsii_str_sheila_smith', 'rickettsia_typhi_str_wilmington', 'roseiflexus_castenholzii_dsm_13941', 'roseiflexus_sp_rs1', 'roseobacter_denitrificans_och_114', 'rubrobacter_xylanophilus_dsm_9941', 'ruegeria_pomeroyi_dss3?silicibacter_pomeroyi_dss3', 'saccharophagus_degradans_240', 'saccharopolyspora_erythraea_nrrl2338?saccharopolyspora_erythraea_nrrl_2338', 'salinibacter_ruber_dsm_13855', 'salinispora_arenicola_cns205', 'salinispora_tropica_cnb440', 'salmonella_enterica_subsp_enterica_serovar_typhimurium_str_lt2?salmonella_typhimurium_lt2', 'serratia_proteamaculans_568', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os195', 'shewanella_denitrificans_os217', 'shewanella_frigidimarina_ncimb_400', 'shewanella_halifaxensis_haweb4', 'shewanella_loihica_pv4', 'shewanella_pealeana_atcc_700345', 'shewanella_putrefaciens_cn32', 'shewanella_sediminis_haweb3', 'shewanella_sp_ana3', 'shewanella_woodyi_atcc_51908', 'shigella_boydii_cdc_308394', 'shigella_dysenteriae_sd197', 'shigella_flexneri_2a_str_301', 'silicibacter_sp_tm1040', 'sinorhizobium_medicae_wsm419', 'sinorhizobium_meliloti_1021', 'sphingomonas_wittichii_rw1', 'sphingopyxis_alaskensis_rb2256', 'staphylococcus_aureus_subsp_aureus_usa300', 'staphylococcus_epidermidis_rp62a', 'staphylococcus_haemolyticus_jcsc1435', 'staphylococcus_saprophyticus_subsp_saprophyticus_atcc_15305', 'staphylothermus_marinus_f1', 'streptococcus_agalactiae_nem316', 'streptococcus_gordonii_str_challis_substr_ch1', 'streptococcus_mutans_ua159', 'streptococcus_pneumoniae_cgsp14', 'streptococcus_pyogenes_mgas10750', 'streptococcus_sanguinis_sk36', 'streptococcus_suis_05zyh33', 'streptococcus_thermophilus_lmd9', 'streptomyces_avermitilis_ma4680', 'streptomyces_coelicolor_a32', 'sulfolobus_acidocaldarius_dsm_639', 'sulfolobus_solfataricus_p2', 'sulfurihydrogenibium_sp_yo3aop1', 'sulfurimonas_denitrificans_dsm_1251', 'sulfurovum_sp_nbc371', 'symbiobacterium_thermophilum_iam_14863', 'synechococcus_elongatus_pcc_7942', 'synechococcus_sp_pcc_7002', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermoanaerobacter_pseudethanolicus_atcc_33223', 'thermoanaerobacter_sp_x514', 'thermoanaerobacter_tengcongensis_mb4', 'thermobifida_fusca_yx', 'thermofilum_pendens_hrk_5', 'thermoplasma_acidophilum_dsm_1728', 'thermoplasma_volcanium_gss1', 'thermoproteus_neutrophilus_v24sta', 'thermosipho_melanesiensis_bi429', 'thermosynechococcus_elongatus_bp1', 'thermotoga_lettingae_tmo', 'thermotoga_petrophila_rku1', 'thermotoga_sp_rq2', 'thermus_thermophilus_hb27', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'treponema_denticola_atcc_35405', 'treponema_pallidum_subsp_pallidum_str_nichols', 'trichodesmium_erythraeum_ims101', 'tropheryma_whipplei_str_twist', 'ureaplasma_parvum_serovar_3_str_atcc_27815', 'verminephrobacter_eiseniae_ef012', 'vibrio_cholerae_o395', 'vibrio_fischeri_es114', 'vibrio_harveyi_atcc_baa1116', 'vibrio_parahaemolyticus_rimd_2210633', 'vibrio_vulnificus_yj016', 'wolbachia_endosymbiont_of_drosophila_melanogaster', 'wolinella_succinogenes_dsm_1740', 'xanthobacter_autotrophicus_py2', 'xanthomonas_axonopodis_pv_citri_str_306', 'xanthomonas_oryzae_pv_oryzae_maff_311018', 'xylella_fastidiosa_9a5c', 'yersinia_enterocolitica_subsp_enterocolitica_8081', 'yersinia_pseudotuberculosis_ip_31758', 'zymomonas_mobilis_subsp_mobilis_zm4']
	assert len(i400.species) == 400
	assert list(i400.abundance) == [0.65800171519999995, 0.52265791289999997, 0.46527747479999998, 0.4092605674, 0.39271579109999999, 0.37989746740000002, 0.3695749545, 0.36102054030000003, 0.35377297229999999, 0.34752393170000001, 0.34205847779999998, 0.3372215683, 0.33289816459999999, 0.32900085759999997, 0.32546187110000002, 0.32222772389999998, 0.3192555655, 0.31651059850000002, 0.31396422639999999, 0.31159269769999998, 0.30937609560000001, 0.30729757400000002, 0.30534277250000003, 0.30349936170000003, 0.3017566867, 0.30010548440000001, 0.2985376569, 0.29704608859999998, 0.29562449750000003, 0.29426731290000002, 0.2929695745, 0.29172684859999998, 0.29053515800000002, 0.28939092249999998, 0.28829090950000003, 0.28723219150000001, 0.28621210930000002, 0.28522824149999998, 0.2842783774, 0.28336049400000002, 0.28247273550000002, 0.28161339629999999, 0.28078090519999999, 0.27997381220000001, 0.27919077650000002, 0.27843055620000001, 0.27769199900000002, 0.27697403390000003, 0.27627566399999998, 0.27559595999999997, 0.27493405440000002, 0.27428913599999999, 0.27366044560000002, 0.27304727150000002, 0.27244894590000002, 0.27186484129999999, 0.27129436750000002, 0.27073696870000002, 0.27019212100000001, 0.26965932990000002, 0.26913812860000003, 0.26862807529999999, 0.2681287524, 0.26763976410000001, 0.2671607352, 0.26669130959999998, 0.26623114939999998, 0.26577993329999999, 0.2653373557, 0.26490312589999998, 0.26447696700000001, 0.26405861479999998, 0.26364781770000001, 0.43181988999999998, 0.26324433530000002, 0.2624584069, 0.26207553189999999, 0.26169911239999999, 0.26132895649999999, 0.26096488000000001, 0.26060670660000002, 0.26025426740000002, 0.25990740000000001, 0.23223404489999999, 0.25956594869999999, 0.25922976390000002, 0.25889870199999998, 0.25857262489999999, 0.25825139959999999, 0.25793489829999999, 0.2576229981, 0.25731558030000001, 0.25701253080000003, 0.25671373959999999, 0.25641910060000001, 0.25612851139999998, 0.25584187330000002, 0.25555909090000001, 0.25528007219999999, 0.25500472819999997, 0.25473297290000002, 0.25446472320000002, 0.2541998989, 0.25393842210000001, 0.25368021759999998, 0.25342521270000001, 0.25317333669999997, 0.25292452129999998, 0.25267870050000002, 0.25243580999999998, 0.25219578770000001, 0.25195857319999998, 0.251724108, 0.25149233539999999, 0.25126320029999999, 0.25103664920000002, 0.25081263009999999, 0.25059109260000001, 0.25037198770000002, 0.25015526770000002, 0.2499408863, 0.24972879849999999, 0.2495189605, 0.2493113297, 0.24910586470000001, 0.24890252500000001, 0.24870127149999999, 0.24850206590000001, 0.24830487100000001, 0.2481096505, 0.24791636910000001, 0.2477249923, 0.2475354867, 0.2473478194, 0.24716195869999999, 0.24697787330000001, 0.24679553300000001, 0.2466149081, 0.2464359699, 0.24625869, 0.246083041, 0.24590899599999999, 0.24573652879999999, 0.24556561369999999, 0.24539622589999999, 0.24522834069999999, 0.24506193430000001, 0.2448969835, 0.24473346530000001, 0.24457135739999999, 0.2444106382, 0.24425128609999999, 0.24409328050000001, 0.24393660079999999, 0.2437812271, 0.24362713990000001, 0.2434743201, 0.243322749, 0.2431724083, 0.24302328000000001, 0.24287534650000001, 0.2427285908, 0.242582996, 0.24243854549999999, 0.2422952233, 0.24215301340000001, 0.24201190049999999, 0.24187186920000001, 0.24173290480000001, 0.24159499249999999, 0.24145811810000001, 0.2413222676, 0.24118742709999999, 0.2410535832, 0.2409207226, 0.24078883240000001, 0.24065789970000001, 0.2405279122, 0.2403988574, 0.2402707234, 0.24014349839999999, 0.24001717080000001, 0.23989172910000001, 0.23976716219999999, 0.23964345910000001, 0.2395206091, 0.23939860139999999, 0.2392774258, 0.23915707210000001, 0.23903753010000001, 0.23891878999999999, 0.2388008422, 0.23868367709999999, 0.22452408700000001, 0.23856728529999999, 0.23845165770000001, 0.23833678520000001, 0.238222659, 0.2381092702, 0.2379966104, 0.23788467099999999, 0.23777344380000001, 0.23766292059999999, 0.2375530934, 0.2374439542, 0.2373354953, 0.23722770900000001, 0.2371205878, 0.2370141244, 0.23690831139999999, 0.23680314159999999, 0.23669860810000001, 0.2365947038, 0.23649142200000001, 0.23638875579999999, 0.23628669869999999, 0.23618524420000001, 0.23608438579999999, 0.23598411729999999, 0.2358844323, 0.23578532469999999, 0.2356867886, 0.2355888179, 0.23549140690000001, 0.2353945496, 0.23529824050000001, 0.23520247399999999, 0.23510724450000001, 0.2350125465, 0.2349183748, 0.23482472400000001, 0.23473158890000001, 0.23463896449999999, 0.2345468456, 0.2344552272, 0.2343641044, 0.2342734725, 0.23418332659999999, 0.2340936619, 0.23400447399999999, 0.233915758, 0.23382750969999999, 0.23373972439999999, 0.2336523979, 0.2335655257, 0.23347910359999999, 0.23339312740000001, 0.2333075929, 0.23322249610000001, 0.23313783269999999, 0.233053599, 0.23296979079999999, 0.2328864044, 0.23280343589999999, 0.2327208815, 0.23263873739999999, 0.26284793820000002, 0.23255700000000001, 0.23247566559999999, 0.2323947307, 0.2323141916, 0.2321542871, 0.2320749147, 0.23199592450000001, 0.23191731309999999, 0.23183907719999999, 0.23176121350000001, 0.23160659010000001, 0.2316837189, 0.2315298241, 0.23145341780000001, 0.231377368, 0.2313016718, 0.23122632630000001, 0.23115132839999999, 0.2310766752, 0.23100236390000001, 0.23092839170000001, 0.23085475580000001, 0.23078145329999999, 0.23070848150000001, 0.23063583779999999, 0.2305635194, 0.23049152379999999, 0.23041984830000001, 0.23034849029999999, 0.23027744720000001, 0.23020671670000001, 0.2301362961, 0.23006618300000001, 0.22999637489999999, 0.22992686949999999, 0.22985766439999999, 0.22978875730000001, 0.22972014569999999, 0.22965182740000001, 0.22958380019999999, 0.2295160617, 0.22944860980000001, 0.22938144220000001, 0.22931455680000001, 0.22924795140000001, 0.229181624, 0.22911557229999999, 0.22904979440000001, 0.22898428809999999, 0.22891905139999999, 0.22885408230000001, 0.22878937890000001, 0.22872493899999999, 0.22866076090000001, 0.22859684259999999, 0.22853318210000001, 0.22719426649999999, 0.2284697775, 0.22840662710000001, 0.22834372889999999, 0.22828108110000001, 0.2282186819, 0.22815652959999999, 0.22809462229999999, 0.2280329583, 0.22797153580000001, 0.2279103532, 0.22784940870000001, 0.2277887006, 0.22772822740000001, 0.2276679872, 0.22760797860000001, 0.2275481999, 0.22748864939999999, 0.22742932569999999, 0.22737022700000001, 0.22731135199999999, 0.227252699, 0.227136053, 0.22707805710000001, 0.22702027720000001, 0.2269627119, 0.2269053597, 0.22684821920000001, 0.22679128900000001, 0.2267345677, 0.22667805390000001, 0.22662174609999999, 0.22656564309999999, 0.2265097435, 0.22645404590000001, 0.226398549, 0.22634325150000001, 0.2262881521, 0.22623324950000001, 0.22617854239999999, 0.2261240296, 0.22606970979999999, 0.2260155818, 0.22596164429999999, 0.22590789610000001, 0.22585433599999999, 0.2258009628, 0.22574777530000001, 0.22569477239999999, 0.22564195279999999, 0.2255893155, 0.22553685919999999, 0.22548458290000001, 0.22543248539999999, 0.2253805656, 0.2253288225, 0.22527725479999999, 0.22522586159999999, 0.22517464170000001, 0.22512359409999999, 0.22507271770000001, 0.22502201159999999, 0.2249714746, 0.22492110570000001, 0.2248709039, 0.2248208683, 0.2247709977, 0.22472129129999999, 0.2246717479, 0.22462236669999999, 0.2245731467, 0.22447518650000001, 0.2244264443, 0.2243778595, 0.22432943129999999, 0.22428115849999999, 0.22423304050000001, 0.22418507609999999, 0.2241372646, 0.22408960510000001, 0.2240420967, 0.22399473850000001, 0.2239475296, 0.22390046920000001, 0.22385355639999999, 0.22380679049999999, 0.22376017049999999]
	assert list(i400.counts) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
	assert list(i400.size) == [5300000.0, 3370000.0, 6100000.0, 860000.0, 1110000.0, 6180000.0, 3100000.0, 750000.0, 4600000.0, 6220000.0, 7210000.0, 7100000.0, 2000000.0, 2230000.0, 7260000.0, 1200000.0, 5310000.0, 4590000.0, 7310000.0, 1690000.0, 3900000.0, 4600000.0, 1600000.0, 8530000.0, 2100000.0, 1800000.0, 3340000.0, 2040000.0, 3200000.0, 2940000.0, 6800000.0, 1010000.0, 4750000.0, 5230000.0, 6620000.0, 5850000.0, 2300000.0, 3300000.0, 780000.0, 1180000.0, 5800000.0, 4300000.0, 6460000.0, 1510000.0, 5430000.0, 5190000.0, 3400000.0, 1590000.0, 6090000.0, 8360000.0, 2640000.0, 5900000.0, 1300000.0, 5700000.0, 3600000.0, 2170000.0, 7100000.0, 5500000.0, 1240000.0, 5030000.0, 2400000.0, 3630000.0, 5900000.0, 2700000.0, 4940000.0, 5250000.0, 1470000.0, 1900000.0, 3270000.0, 1600000.0, 6910000.0, 5100000.0, 2100000.0, 800000.0, 5270000.0, 2200000.0, 5910000.0, 2700000.0, 1900000.0, 730000.0, 3850000.0, 5800000.0, 660000.0, 3800000.0, 6500000.0, 2000000.0, 2400000.0, 3710000.0, 2560000.0, 2750000.0, 4550000.0, 2100000.0, 3900000.0, 4500000.0, 3400000.0, 1700000.0, 2310000.0, 6720000.0, 5960000.0, 3800000.0, 5100000.0, 4060000.0, 1300000.0, 3810000.0, 1930000.0, 3150000.0, 5300000.0, 2700000.0, 4300000.0, 3970000.0, 1900000.0, 3700000.0, 1110000.0, 2100000.0, 9100000.0, 3600000.0, 9010000.0, 5200000.0, 1900000.0, 1600000.0, 4540000.0, 1910000.0, 2100000.0, 4700000.0, 5900000.0, 5010000.0, 2300000.0, 7900000.0, 4150000.0, 4730000.0, 4600000.0, 2650000.0, 1770000.0, 2600000.0, 2300000.0, 2620000.0, 2800000.0, 5200000.0, 2000000.0, 4310000.0, 1900000.0, 980000.0, 3590000.0, 2660000.0, 1900000.0, 2940000.0, 5800000.0, 2590000.0, 2130000.0, 2500000.0, 4690000.0, 2400000.0, 4850000.0, 2810000.0, 2580000.0, 880000.0, 1550000.0, 2150000.0, 7800000.0, 1760000.0, 5000000.0, 2370000.0, 6600000.0, 2570000.0, 490000.0, 1520000.0, 3980000.0, 6380000.0, 2200000.0, 1800000.0, 2690000.0, 4080000.0, 1900000.0, 1800000.0, 1230000.0, 3300000.0, 4300000.0, 2300000.0, 2920000.0, 2000000.0, 6000000.0, 2500000.0, 2350000.0, 2400000.0, 7500000.0, 3800000.0, 3600000.0, 6000000.0, 2500000.0, 2900000.0, 3300000.0, 1900000.0, 1200000.0, 4090000.0, 4000000.0, 2840000.0, 2560000.0, 5350000.0, 4600000.0, 9100000.0, 1800000.0, 5200000.0, 4020000.0, 5800000.0, 1500000.0, 3100000.0, 1770000.0, 2870000.0, 5300000.0, 1600000.0, 1270000.0, 3700000.0, 2300000.0, 2150000.0, 790000.0, 1040000.0, 960000.0, 3700000.0, 4430000.0, 5500000.0, 3950000.0, 4900000.0, 5220000.0, 2360000.0, 1180000.0, 8400000.0, 2490000.0, 3640000.0, 1600000.0, 9670000.0, 5690000.0, 4390000.0, 2300000.0, 5080000.0, 3010000.0, 1400000.0, 3240000.0, 4400000.0, 3600000.0, 4280000.0, 1200000.0, 5500000.0, 1400000.0, 1520000.0, 5500000.0, 1800000.0, 2180000.0, 4660000.0, 2200000.0, 1470000.0, 3300000.0, 1700000.0, 3730000.0, 1580000.0, 1600000.0, 5360000.0, 2250000.0, 5260000.0, 5630000.0, 5200000.0, 2030000.0, 3540000.0, 2100000.0, 5310000.0, 1800000.0, 3100000.0, 7780000.0, 8200000.0, 5450000.0, 2200000.0, 3200000.0, 2060000.0, 5000000.0, 1410000.0, 7790000.0, 4910000.0, 3090000.0, 3700000.0, 4130000.0, 4840000.0, 160000.0, 4200000.0, 9090000.0, 2730000.0, 4710000.0, 2560000.0, 1990000.0, 5510000.0, 5930000.0, 1580000.0, 2100000.0, 3230000.0, 3000000.0, 6530000.0, 5600000.0, 2200000.0, 1700000.0, 2820000.0, 4100000.0, 2910000.0, 2200000.0, 4410000.0, 1800000.0, 4860000.0, 4610000.0, 5690000.0, 580000.0, 4800000.0, 1000000.0, 3540000.0, 6820000.0, 3320000.0, 3400000.0, 6990000.0, 3920000.0, 1200000.0, 1810000.0, 3290000.0, 4700000.0, 3000000.0, 1830000.0, 7000000.0, 4990000.0, 4200000.0, 3300000.0, 4100000.0, 4770000.0, 2200000.0, 2930000.0, 3100000.0, 3900000.0, 6740000.0, 3590000.0, 1900000.0, 3230000.0, 5370000.0, 4900000.0, 4990000.0, 860000.0, 4670000.0, 2260000.0, 4800000.0, 7600000.0, 9770000.0, 5700000.0, 2000000.0, 1140000.0, 4270000.0, 6540000.0, 1700000.0, 1800000.0, 1800000.0, 2400000.0, 1670000.0, 930000.0, 790000.0, 5280000.0, 5620000.0, 8700000.0, 1300000.0, 1000000.0, 2410000.0, 4400000.0, 3050000.0, 1360000.0, 2400000.0, 2750000.0, 4100000.0, 1900000.0, 4250000.0, 6920000.0, 4970000.0, 5170000.0, 1080000.0, 4820000.0, 4230000.0, 6290000.0, 4660000.0, 9090000.0, 5400000.0, 4800000.0, 1600000.0, 3370000.0, 1760000.0, 1940000.0, 2480000.0, 3020000.0, 2100000.0, 3640000.0, 2410000.0, 3000000.0, 2580000.0, 3600000.0, 2800000.0, 1700000.0, 1200000.0, 2100000.0, 1590000.0, 2600000.0, 1400000.0]
	assert round(np.sum(i400.abundance),5) == 100

def test_simLC_truth():
	simlc,temp1,temp2,temp3,temp4 = mc.dataset_truth('simLC')
	assert simlc.species == ['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichii_mlhe1?alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_btai1bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_spstrain_383?burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb40?burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm_11300?deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_338890?thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon']
	assert list(simlc.abundance) == [0.49, 0.52, 0.45, 0.61, 0.53, 0.55, 0.55, 0.58, 0.55, 5.08, 0.56, 0.58, 0.55, 0.57, 1.35, 0.61, 0.53, 0.56, 0.62, 0.52, 0.46, 0.58, 0.56, 0.56, 0.54, 0.59, 5.27, 0.54, 0.76, 0.66, 0.59, 0.67, 0.67, 0.6, 0.56, 0.55, 0.54, 0.56, 0.58, 0.52, 0.57, 0.54, 0.35, 0.57, 0.48, 0.58, 0.56, 0.52, 0.48, 0.57, 0.58, 0.47, 0.51, 0.55, 0.56, 1.16, 0.65, 0.57, 0.53, 0.53, 0.54, 0.58, 0.66, 0.46, 0.58, 0.54, 0.6, 0.57, 0.48, 0.6, 0.64, 0.48, 0.62, 0.51, 0.8, 0.51, 0.51, 0.51, 0.55, 0.56, 0.62, 0.56, 0.58, 0.52, 0.57, 0.53, 24.49, 0.58, 0.57, 0.52, 0.56, 0.55, 0.51, 0.55, 0.6, 0.54, 0.52, 0.51, 0.66, 0.59, 0.56, 0.43, 0.53, 0.55, 0.48, 0.6, 0.54, 0.61, 0.51, 0.57, 0.57, 2.51, 1.04]
	assert list(simlc.counts) == [252, 373, 489, 855, 584, 570, 650, 520, 288, 9277, 542, 955, 879, 956, 1074, 992, 1149, 367, 381, 359, 199, 679, 454, 737, 461, 812, 5168, 537, 415, 769, 484, 196, 150, 359, 377, 238, 645, 1109, 515, 232, 543, 566, 177, 362, 195, 244, 301, 235, 504, 547, 567, 268, 545, 429, 365, 674, 630, 427, 409, 314, 378, 636, 520, 182, 585, 217, 489, 508, 250, 402, 733, 183, 253, 282, 483, 588, 730, 675, 746, 327, 422, 514, 599, 636, 699, 575, 28861, 559, 409, 582, 536, 621, 551, 565, 664, 568, 524, 533, 469, 438, 263, 178, 316, 606, 314, 315, 434, 395, 274, 277, 977, 2836, 601]
	assert list(simlc.size) == [2319663.0, 3275944.0, 4929566.0, 6365727.0, 5013479.0, 4698945.0, 5365318.0, 4087024.0, 2375792.0, 8264687.0, 4367044.0, 7484988.0, 7279118.0, 7537985.0, 3587082.0, 7305582.0, 9731140.0, 2970275.0, 2763181.0, 3133902.0, 1966858.0, 5258541.0, 3696649.0, 6000632.0, 3843301.0, 6238478.0, 4433218.0, 4501104.0, 2467205.0, 5279134.0, 3730232.0, 1315030.0, 1005936.0, 2698137.0, 3034136.0, 1947953.0, 5433628.0, 8982042.0, 3997420.0, 2007700.0, 4317977.0, 4761183.0, 2291220.0, 2895264.0, 1856951.0, 1894360.0, 2438589.0, 2038396.0, 4719581.0, 4326849.0, 4412446.0, 2575032.0, 4837408.0, 3544738.0, 2971517.0, 2628784.0, 4406967.0, 3402093.0, 3481691.0, 2661057.0, 3184243.0, 4985871.0, 3561584.0, 1780517.0, 4582380.0, 1832387.0, 3665893.0, 4008000.0, 2364842.0, 3018238.0, 5200264.0, 1709204.0, 1842899.0, 2512923.0, 2736403.0, 5187005.0, 6438405.0, 5959964.0, 6093698.0, 2650701.0, 3059876.0, 4131626.0, 4712337.0, 5505494.0, 5513844.0, 4892717.0, 5331656.0, 4352825.0, 3225748.0, 5057531.0, 4306142.0, 5127376.0, 4845257.0, 4659220.0, 4972204.0, 4792610.0, 4602594.0, 4708380.0, 3200938.0, 3345170.0, 2143334.0, 1856368.0, 2695903.0, 4990251.0, 2936195.0, 2362816.0, 3642249.0, 2909809.0, 2427734.0, 2201561.0, 7750108.0, 5115560.0, 2622359.0]
	assert np.sum(simlc.abundance) == 99.98
	assert np.sum(simlc.counts) == 100628

def test_xprs_input():
	# i100 express data
	truth,temp1,temp2,temp3,temp4 = mc.dataset_truth('i100') # get sizes for process_input
	test,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_1.xprs',truth.size)
	assert test.species == truth.species
	assert test.counts == [234629, 213760.310134, 346706, 419783.882839, 383225.415617, 341431.949696, 527556.388114, 370053.769894, 268292.464229, 252582, 255483.375161, 348831.143398, 374089.490633, 434216.50783, 76330.818648, 25003.805463, 622392.549366, 433035.731062, 149229, 49913.184351, 68712.666882, 71288.170978, 74878.690298, 149806, 314425.789323, 397185.090472, 268466.222044, 198497.61575, 245521, 218375.770032, 161110.797489, 128066, 351901, 290454, 307753.334438, 344533.199106, 332812.370121, 219143.196593, 502007.164229, 113850, 230958.696804, 112050.986698, 129028.702287, 212194, 404085, 250388.424192, 177646.663253, 83196, 146165, 130504.949106, 167933.669028, 218923.755127, 109296.362415, 230036, 172045.6361, 114988.199135, 293558.49435, 270674.57774, 396721.935148, 673559.758298, 277188.899908, 144700.690202, 143058.036782, 550636.58284, 361127.967637, 167467.44071, 124540.462381, 491350.015719, 279650.202372, 396186.436754, 270906.582852, 27397.621216, 584827.354294, 403978.597309, 379098.76153, 68708.120797, 371096.721547, 295481.138781, 400436.648204, 271121, 231883.616698, 177537.385478, 168943.484771, 213001.300494, 178354.006181, 185813.844142, 156112.525783, 168763.97704, 114106.819046, 129895.51704, 204254.88706, 238582.627937, 182898, 120948, 144142, 216493.991574, 174017.797069, 45128.941671, 63178.82471, 295609.497603]
	assert test.abundance == [0.96751926368479724, 1.1011219779976515, 0.95869732131068996, 0.83841496955525441, 1.0017894116673542, 0.8583584525432818, 1.3290421773731256, 0.86540366499758392, 0.88340720428155772, 0.83247683583437782, 0.83191124712788844, 0.89723948121373331, 0.76141822785592739, 1.4859935911212121, 1.1183751720318926, 0.92032966754102863, 1.185648826794417, 1.1322030673859678, 1.059858466234983, 0.89557776771907016, 0.88131025402889873, 0.8138127736517341, 0.812672833082554, 0.91525726062653445, 1.1391332634151285, 0.90748324568149441, 0.89704559638278059, 1.0670778464187851, 0.84331065281968998, 1.0542044048276304, 1.0943790944322926, 0.92036398990281676, 0.90545640067844535, 0.89542112630197268, 1.1547736715768302, 0.92708679123521442, 0.94038926234872233, 0.71064450082584485, 1.6124959581219982, 0.84517501430150743, 0.9116577942168681, 0.89250336041846245, 0.90819415672832127, 0.9172727865528234, 0.9295265999742478, 1.0764620913158061, 0.90654449257343472, 0.91181480076547394, 1.1513805044694017, 0.85557907150144974, 0.90624691039410044, 1.3030276527951692, 0.8661788391898867, 0.77226007773442429, 0.85995809368151954, 0.90965869920845654, 1.0878903423967703, 1.0485214980311153, 0.99868944516115943, 1.9244880524347892, 1.0543924475544491, 0.98037481383204095, 0.91505096132429642, 0.85891965967167061, 1.0428283675523653, 1.0248701045754314, 0.93675656897179305, 1.4130461578498827, 1.038612559156544, 1.8521416256262624, 0.86365030349431571, 0.14150518252254451, 0.98711222042477387, 1.2584268390458555, 1.1848203434018898, 0.87606696556848007, 1.1511899058220243, 0.92056152604885344, 0.9467922084797743, 0.97285712120588763, 1.1156545771629109, 0.86469165855623176, 0.82888978389599655, 1.0683601882762357, 0.89429213967804411, 0.91254360325621187, 1.0046593453232657, 1.1297168869453695, 0.84332306729097517, 0.99159895639981754, 1.1630300252444479, 1.3084954971332452, 0.85790678486740857, 0.87212281501489752, 1.0227819174789734, 1.3120551642084974, 0.82964305019779638, 0.92059219709555795, 1.3447698519653315, 0.89476060340330277]

def test_kallisto_input():
	truth,temp1,temp2,temp3,temp4 = mc.dataset_truth('i100') # get sizes for process_input
	test,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_1_expression.txt',truth.size)
	assert test.species == truth.species
	assert round_list(test.counts) == round_list([227125.245872075, 205892.628469898, 335437.407378266, 405669.488573947, 363047.512505824, 323003.920284744, 500610.674757999, 350108.785887382, 256702.436128019, 245414.768973164, 243437.573928881, 328994.392632965, 359850.254084938, 416286.422950234, 72867.59552123, 23745.9629940087, 596915.390988033, 414832.658024, 143591.016407652, 47640.8795957722, 65605.0240624559, 68025.5667559934, 71490.2688378772, 144458.766487681, 301148.03033363, 381606.168006518, 256838.835122017, 192830.682187292, 236898.056574801, 212673.877049681, 155945.94149779, 123282.525035492, 338837.920270499, 279580.40238898, 293872.481153965, 328315.728649291, 321325.937008063, 157339.617169479, 523160.998736484, 109910.024164995, 222094.153544456, 107558.923831178, 124174.852331605, 203953.563764777, 388579.169119296, 239173.00042609, 170674.999060357, 79554.0, 142677.67801791, 126836.10841009, 158991.854902965, 210782.188677737, 104437.345838596, 221235.439934519, 164494.722282312, 110406.146959726, 281739.016444819, 266076.791264046, 385289.195960603, 645442.951277472, 254984.768076517, 139463.241941437, 138505.066401307, 537113.815755688, 348195.837205803, 160488.945091011, 119149.274932955, 468717.73435184, 268492.94377528, 379915.18161147, 261409.747138874, 26479.5937534052, 565328.736219948, 386692.260177731, 361549.061916575, 65610.2114150745, 354001.395239016, 283803.490818746, 386328.92834288, 266649.595781101, 215013.360645588, 167607.573732409, 166241.70136134, 199933.378867343, 180738.061674824, 168262.648021547, 149773.143207458, 162089.131089375, 109204.371088291, 123039.057708521, 186280.363469031, 238018.895367754, 175998.458329281, 116421.276749397, 138747.713986727, 206120.469683309, 166977.003080403, 43319.6924887271, 60127.5834142537, 284388.316587194])
	assert round_list(test.abundance) == round_list([1.0093804296578504, 0.9714631348716433, 1.0517367692188202, 0.8870177377550211, 1.0734674237203001, 0.9189604524703922, 1.4257211423165803, 0.9260790043854202, 0.9218921256328771, 0.9026483681887022, 0.8927850808964483, 0.9570791582343833, 0.8837574946180102, 1.2050895453518204, 1.1415605769354003, 0.8695796851758172, 1.0632956108034501, 0.9106868562553132, 1.0572571174758303, 0.9305343315333052, 0.9763707275042222, 0.8902394039692192, 0.8984017539780862, 0.9442438180512293, 0.9797003306524903, 0.9829159158970102, 0.9665977932088913, 1.1699345287237202, 0.9527331693650991, 1.0210516180349403, 1.0174453995806503, 0.9375359490059891, 0.9591130801795602, 0.9747557907242344, 1.1166155156148903, 0.9230278903853361, 0.9461216802790032, 0.5241559655443901, 1.7403296312058705, 0.8977087541804702, 0.9000287735675302, 0.9085030721480453, 0.9536108331223452, 0.9915506921778011, 0.8851087782035951, 0.9977858648803853, 0.9291503709431721, 0.9478608828476921, 1.1877307815984701, 0.9187616736471202, 0.9458287608618252, 1.3773267189318703, 0.9391729314680282, 0.8821822004056121, 0.9035214969301322, 0.9627784003489922, 0.9016220660194013, 0.9464049762568592, 0.8941250497074673, 1.6493518417052302, 0.8907681548244901, 1.0008738418243903, 0.9421800077161931, 0.9163574031933174, 1.03380822280165, 1.0289914540102603, 0.9877277304134813, 1.25461042813058, 0.9085925156176072, 1.8936344078511307, 0.8861399680101723, 0.12164448159331503, 0.9005205422697993, 1.0855998098368302, 1.0204672446872003, 0.912594833445968, 1.1260895706056404, 0.9140337549634352, 0.8923105326956393, 0.9601511083588191, 1.1316155821204001, 0.8925496943487402, 0.8921778143263802, 1.0957099160372203, 0.9901967151520243, 0.9034224616835592, 1.07170641661278, 1.2290591506009703, 0.8882344897913781, 1.0344987337877602, 1.0679218761891702, 1.3156242535264304, 0.9265142133530703, 0.9396566472042112, 0.9761151482800383, 1.0949273223010403, 0.9077769406882983, 0.8911062959892463, 1.3226075338002503, 0.9100858540028461])
'''
def test_gasic_input():
	# i100 gasic data
	test_species,test_abundance,test_counts,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_2.txt',[3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0])
	assert test_species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', 'sodalis_glossinidius_str_morsitans', 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert list(test_counts) == [235101.540521, 201447.602453, 344850.566872, 420147.964386, 198186.858763, 270947.151434, 476296.849749, 396217.495491, 256487.492585, 251937.311265, 242987.712799, 511843.990812, 374648.024411, 414538.143227, 68405.8645448, 12539.1927809, 608115.705508, 401128.660273, 145610.36132, 40792.9590834, 63701.6981651, 65203.6761317, 72664.0815683, 146089.757059, 289726.573577, 390561.527088, 256959.565176, 192822.411437, 240581.19332, 213614.285035, 154052.810374, 124392.658782, 351371.544771, 290160.234145, 301948.529199, 251823.208095, 639222.0377, 355533.938376, 138822.553958, 106135.938603, 222707.087134, 107321.397943, 126418.232998, 213920.337069, 401836.832957, 240672.496088, 168732.926303, 84154.9362148, 142293.854617, 126258.698677, 151009.411292, 214271.824875, 103791.988364, 226860.764588, 163919.799824, 114294.949741, 256248.203838, 99815.3053165, 369181.714533, 652328.484917, 433917.417358, 170536.848988, 106053.296603, 552560.211893, 358203.411231, 163709.967208, 118229.637846, 481556.216643, 263429.906693, 396077.203924, 265355.637329, 10121.9053372, 570581.430956, 388630.317742, 354175.721541, 63741.5644336, 349374.628711, 292131.872235, 393488.221169, 273284.577832, 151965.660579, 102184.558357, 54516.1958614, 73125.3557114, 644006.276341, 103810.244575, 146872.219436, 165579.41592, 181799.55293, 54128.4385649, 273797.580414, 169590.558817, 179181.889629, 115850.193212, 141469.952191, 205358.925885, 168476.335941, 38157.0345743, 55066.8181038, 290932.707122]
	assert list(test_abundance) == [1.0446256785349561, 0.95029908030784549, 1.0810777617963336, 0.91855102638203967, 0.5859123949121201, 0.77073893480132383, 1.3562690167928007, 1.0478873536588382, 0.92096180983163811, 0.92647720430906366, 0.89098026968778166, 1.4887779715406073, 0.91996813774730457, 1.1998437451279955, 1.0711439061789487, 0.45871649895635092, 1.0831112591496852, 0.88048261885453705, 1.071836787728389, 0.79631422619758552, 0.94760513695271509, 0.85295397561483666, 0.9127842767489549, 0.95466788273243075, 0.9423899852617067, 1.0058359217995692, 0.9668815666478866, 1.1696084268730349, 0.96736852106359572, 1.0253581634019873, 1.0048450417561359, 0.94571761862838288, 0.99443920299096511, 1.0114711041541022, 1.1470982970981805, 0.70786908370928048, 1.881852226420341, 1.1842182118392519, 0.46172614444412152, 0.8666318238131272, 0.90234673077952265, 0.90622733454071924, 0.97056968408852118, 1.0397927146501911, 0.91518083083151136, 1.0038537911389345, 0.91837589897577065, 1.0022918172706241, 1.1841872352424092, 0.91433562035442406, 0.89813275969436823, 1.399782151267619, 0.93307882860750135, 0.90444852731547121, 0.90016460916829655, 0.99638674494404011, 0.81991355513144681, 0.35497098852494297, 0.85662584487085891, 1.6667049239295808, 1.5155977049420677, 1.223553425713592, 0.72124316777210717, 0.9425939084736441, 1.0633553370418753, 1.0493864773833996, 0.97981671445555152, 1.2887838018030531, 0.89131044133614423, 1.9737813076631423, 0.89936594574742434, 0.046489774469276511, 0.9087782304627553, 1.0908751763564415, 0.99950403290876555, 0.88621468009369531, 1.1111923422380741, 0.9407038311644883, 0.90872025572174786, 0.98387287970889137, 0.79962342227637417, 0.54403884970482386, 0.29251113129211603, 0.400665929584887, 3.5274926405811491, 0.55724831286156784, 1.0506713777384038, 1.255179408897281, 1.4782735737440718, 0.45497107222840516, 1.5692903985865541, 0.9371858349391502, 0.94306991958957664, 0.93477844117215181, 0.99500698397793508, 1.0906459135932876, 0.91572700283290576, 0.78442922111847591, 1.2105040419426416, 0.9308782021085954]
	assert np.sum(test_abundance) == 100
'''
def test_abundance_calc():
	# simLC original counts, should calculate correct abundances
	test,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_3.txt',[2319663.0, 3275944.0, 4929566.0, 6365727.0, 5013479.0, 4698945.0, 5365318.0, 4087024.0, 2375792.0, 8264687.0, 4367044.0, 7484988.0, 7279118.0, 7537985.0, 3587082.0, 7305582.0, 9731140.0, 2970275.0, 2763181.0, 3133902.0, 1966858.0, 5258541.0, 3696649.0, 6000632.0, 3843301.0, 6238478.0, 4433218.0, 4501104.0, 2467205.0, 5279134.0, 3730232.0, 1315030.0, 1005936.0, 2698137.0, 3034136.0, 1947953.0, 5433628.0, 8982042.0, 3997420.0, 2007700.0, 4317977.0, 4761183.0, 2291220.0, 2895264.0, 1856951.0, 1894360.0, 2438589.0, 2038396.0, 4719581.0, 4326849.0, 4412446.0, 2575032.0, 4837408.0, 3544738.0, 2971517.0, 2628784.0, 4406967.0, 3402093.0, 3481691.0, 2661057.0, 3184243.0, 4985871.0, 3561584.0, 1780517.0, 4582380.0, 1832387.0, 3665893.0, 4008000.0, 2364842.0, 3018238.0, 5200264.0, 1709204.0, 1842899.0, 2512923.0, 2736403.0, 5187005.0, 6438405.0, 5959964.0, 6093698.0, 2650701.0, 3059876.0, 4131626.0, 4712337.0, 5505494.0, 5513844.0, 4892717.0, 5331656.0, 4352825.0, 3225748.0, 5057531.0, 4306142.0, 5127376.0, 4845257.0, 4659220.0, 4972204.0, 4792610.0, 4602594.0, 4708380.0, 3200938.0, 3345170.0, 2143334.0, 1856368.0, 2695903.0, 4990251.0, 2936195.0, 2362816.0, 3642249.0, 2909809.0, 2427734.0, 2201561.0, 7750108.0, 5115560.0, 2622359.0])
	assert test.species == ['actinobacillus_succinogenes_130z', 'alkalilimnicola_ehrlichei_mlhe1', 'alkaliphillus_metalliredigenes_undef', 'anabaena_variabilis_atcc_29413', 'anaeromyxobacter_dehalogenans_2cpc', 'arthrobacter_sp_fb24', 'azotobacter_vinelandii_avop', 'bacillus_cereus_nvh39198', 'bifidobacterium_longum_djo10a', 'bradyrhizobium_sp_btai1', 'brevibacterium_linens_bl2', 'burkholderia_ambifaria_ammd', 'burkholderia_cenocepacia_au_1054', 'burkholderia_cenocepacia_hi2424', 'burkholderia_sp_383', 'burkholderia_vietnamiensis_g4', 'burkholderia_xenovorans_lb400', 'caldicellulosiruptor_accharolyticus_undef', 'chlorobium_limicola_dsmz_245t', 'chlorobium_phaeobacteroides_dsm_266', 'chlorobium_vvibrioforme_f_thiosulfatophilum_dsmz_265t', 'chloroflexus_aurantiacus_j10fl', 'chromohalobacter_salexigens_dsm3043', 'clostridium_beijerincki_ncimb_8052', 'clostridium_thermocellum_atcc_27405', 'crocosphaera_watsonii_wh_8501', 'cytophaga_hutchinsonii_atcc_33406', 'dechloromonas_aromatica_rcb', 'deinococcus_geothermalis_dsm11300', 'desulfitobacterium_hafniense_dcb2', 'desulfovibrio_desulfuricans_g20', 'ehrlichia_canis_jake', 'ehrlichia_chaffeensis_sapulpa', 'enterococcus_faecium_do', 'exiguobacterium_undef_25515', 'ferroplasma_acidarmanus_fer1', 'frankia_sp_cci3', 'frankia_sp_ean1pec', 'geobacter_metallireducens_gs15', 'haemophilus_somnus_129pt', 'jannaschia_sp_ccs1', 'kineococcus_radiotolerans_srs30216', 'lactobacillus_brevis_atcc_367', 'lactobacillus_casei_atcc_334', 'lactobacillus_delbrueckii_bulgaricus_atcc_baa365', 'lactobacillus_gasseri_atcc_33323', 'lactococcus_lactis_cremoris_sk11', 'leuconostoc_mesenteroides_mesenteroides_atcc_8293', 'magnetococcus_sp_mc1', 'marinobacter_aquaeolei_vt8', 'mesorhizobium_sp_bnc1', 'methanococcoides_burtonii_dsm6242', 'methanosarcina_barkeri_fusaro', 'methanospirillum_hungatei_jf1', 'methylobacillus_flagellatus_strain_kt', 'moorella_thermoacetica_atcc_39073', 'nitrobacter_hamburgensis_undef', 'nitrobacter_winogradskyi_nb255', 'nitrosococcus_oceani_undef', 'nitrosomonas_eutropha_c71', 'nitrosospira_multiformis_atcc_25196', 'nocardioides_sp_js614', 'novosphingobium_aromaticivorans_dsm_12444_f199', 'oenococcus_oeni_psu1', 'paracoccus_denitrificans_pd1222', 'pediococcus_pentosaceus_atcc_25745', 'pelobacter_carbinolicus_dsm_2380', 'pelobacter_propionicus_dsm_2379', 'pelodictyon_luteolum_undef', 'pelodictyon_phaeoclathratiforme_bu1_dsmz_5477t', 'polaromonas_sp_js666', 'prochlorococcus_marinus_str_mit_9312', 'prochlorococcus_sp_natl2a', 'prosthecochloris_aestuarii_sk413dsmz_271t', 'prosthecochloris_sp_bs1', 'pseudoalteromonas_atlantica_t6c', 'pseudomonas_fluorescens_pfo1', 'pseudomonas_putida_f1', 'pseudomonas_syringae_b728a', 'psychrobacter_arcticum_2734', 'psychrobacter_cryopegella_undef', 'rhodobacter_sphaeroides_241', 'rhodoferax_ferrireducens_undef', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_bisb18', 'rhodopseudomonas_palustris_bisb5', 'rhodopseudomonas_palustris_haa2', 'rhodospirillum_rubrum_atcc_11170', 'rubrobacter_xylanophilus_dsm_9941', 'saccharophagus_degradans_240', 'shewanella_amazonensis_sb2b', 'shewanella_baltica_os155', 'shewanella_frigidimarina_ncmb400', 'shewanella_putefaciens_undef', 'shewanella_sp_ana3', 'shewanella_sp_mr7', 'shewanella_sp_pv4', 'shewanella_sp_w3181', 'silicibacter_sp_tm1040', 'sphingopyxis_alaskensis_rb2256', 'streptococcus_suis_891591', 'streptococcus_thermophilus_lmd9', 'synechococcus_sp_pcc_7942_elongatus', 'syntrophobacter_fumaroxidans_mpob', 'syntrophomonas_wolfei_goettingen', 'thermoanaerobacter_ethanolicus_39e', 'thermobifida_fusca_yx', 'thiobacillus_denitrificans_atcc_25259', 'thiomicrospira_crunogena_xcl2', 'thiomicrospira_denitrificans_atcc_33889', 'trichodesmium_erythraeum_ims101', 'xylella_fastidiosa_ann1', 'xylella_fastidiosa_dixon']
	assert test.counts == [252.0, 373.0, 489.0, 855.0, 584.0, 570.0, 650.0, 520.0, 288.0, 9277.0, 542.0, 955.0, 879.0, 956.0, 1074.0, 992.0, 1149.0, 367.0, 381.0, 359.0, 199.0, 679.0, 454.0, 737.0, 461.0, 812.0, 5168.0, 537.0, 415.0, 769.0, 484.0, 196.0, 150.0, 359.0, 377.0, 238.0, 645.0, 1109.0, 515.0, 232.0, 543.0, 566.0, 177.0, 362.0, 195.0, 244.0, 301.0, 235.0, 504.0, 547.0, 567.0, 268.0, 545.0, 429.0, 365.0, 674.0, 630.0, 427.0, 409.0, 314.0, 378.0, 636.0, 520.0, 182.0, 585.0, 217.0, 489.0, 508.0, 250.0, 402.0, 733.0, 183.0, 253.0, 282.0, 483.0, 588.0, 730.0, 675.0, 746.0, 327.0, 422.0, 514.0, 599.0, 636.0, 699.0, 575.0, 28861.0, 559.0, 409.0, 582.0, 536.0, 621.0, 551.0, 565.0, 664.0, 568.0, 524.0, 533.0, 469.0, 438.0, 263.0, 178.0, 316.0, 606.0, 314.0, 315.0, 434.0, 395.0, 274.0, 277.0, 977.0, 2836.0, 601.0]
	assert [round(i,10) for i in test.abundance] == [round(i,10) for i in (0.4914472977119464, 0.51507879203630236, 0.44874691859582572, 0.60760230264843462, 0.52695672685272965, 0.5487516003743127, 0.54804875440765999, 0.57556908829524811, 0.54838476141364312, 5.0778802152599649, 0.56145250620163922, 0.5771830503711517, 0.54627512023508185, 0.57372520428966989, 1.3544540701120431, 0.61426837727555761, 0.53414308926557041, 0.55894710386835, 0.62375917614755771, 0.51821543339088172, 0.45770048827841431, 0.58412502925336929, 0.55558299276038836, 0.55561223427184514, 0.5426225430135988, 0.58881475890645874, 5.2735700955775089, 0.53970512731161602, 0.76092905283129564, 0.6589689626736468, 0.58696313295922142, 0.67425118232762804, 0.6745625307178887, 0.60191027480611659, 0.56209226982659255, 0.55271313927408161, 0.53699608360583206, 0.55854448828403414, 0.58281236057026531, 0.52274570325863223, 0.56888019012580038, 0.53777779092231248, 0.34946829462132473, 0.565616025969499, 0.47504578961442662, 0.58267799528303721, 0.558379147132404, 0.52153157831469477, 0.48309038999537735, 0.57189578134638841, 0.58130620842563741, 0.47081844597209332, 0.50966532762397476, 0.54748781403721747, 0.55566872156227287, 1.1598619454185031, 0.6466988026869651, 0.56778380323602429, 0.53141570990493625, 0.53379779650134584, 0.53701560133085946, 0.57705523302487693, 0.66048271710587148, 0.46240930984218592, 0.57751872655932013, 0.53572737366196832, 0.60343483907324913, 0.57337308852514468, 0.47823260771771803, 0.60252334204678926, 0.63764636558050225, 0.48434909780124596, 0.62104102893234425, 0.50765799816883872, 0.798487972407113, 0.51281647056228052, 0.51291555982904469, 0.51234374948423111, 0.55380797614144073, 0.55806953704039108, 0.62389273662483302, 0.56278617865334102, 0.57503170027417805, 0.52259124280890612, 0.57348756692700642, 0.53164171971337859, 24.487844560982609, 0.58095421440900064, 0.57358023454858464, 0.52057791193625769, 0.56308991415908316, 0.54789550802339315, 0.51444160805646544, 0.54857566238358935, 0.6041161509191938, 0.53613918770124669, 0.51502691534921485, 0.51210263285011359, 0.66282195656233267, 0.59232112657612979, 0.55509485382978285, 0.43376772505681693, 0.53025421145214979, 0.54935304956743258, 0.48377793810168668, 0.60308976288906269, 0.53904050768760348, 0.61409267730995609, 0.5105646804486903, 0.56918094415845166, 0.57027996600866715, 2.5079238732299789, 1.0367728880092018)]
	assert [round(i,2) for i in test.abundance] == [0.49,0.52,0.45,0.61,0.53,0.55,0.55,0.58,0.55,5.08,0.56,0.58,0.55,0.57,1.35,0.61,0.53,0.56,0.62,0.52,0.46,0.58,0.56,0.56,0.54,0.59,5.27,0.54,0.76,0.66,0.59,0.67,0.67,0.6,0.56,0.55,0.54,0.56,0.58,0.52,0.57,0.54,0.35,0.57,0.48,0.58,0.56,0.52,0.48,0.57,0.58,0.47,0.51,0.55,0.56,1.16,0.65,0.57,0.53,0.53,0.54,0.58,0.66,0.46,0.58,0.54,0.6,0.57,0.48,0.6,0.64,0.48,0.62,0.51,0.8,0.51,0.51,0.51,0.55,0.56,0.62,0.56,0.58,0.52,0.57,0.53,24.49,0.58,0.57,0.52,0.56,0.55,0.51,0.55,0.6,0.54,0.52,0.51,0.66,0.59,0.56,0.43,0.53,0.55,0.48,0.6,0.54,0.61,0.51,0.57,0.57,2.51,1.04]
	assert np.sum(test.abundance) == 100

def test_plasmid():
	# i100 express data with plasmids
	test,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_4.xprs',[3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0])
	assert test.species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert test.counts == [234629, 213760.310134, 346706, 419783.882839, 383225.415617, 341431.949696, 527556.388114, 370053.769894, 268292.464229, 252582, 255483.375161, 348831.143398, 374089.490633, 434216.50783, 76330.818648, 25003.805463, 622392.549366, 433035.731062, 149229, 49913.184351, 68712.666882, 71288.170978, 74878.690298, 149806, 314425.789323, 397185.090472, 268466.222044, 198497.61575, 245521, 218375.770032, 161110.797489, 128066, 351901, 290454, 307753.334438, 344533.199106, 332812.370121, 219143.196593, 502007.164229, 113850, 230958.696804, 112050.986698, 129028.702287, 212194, 404085, 250388.424192, 177646.663253, 83196, 146165, 130504.949106, 167933.669028, 218923.755127, 109296.362415, 230036, 172045.6361, 114988.199135, 293558.49435, 270674.57774, 396721.935148, 673559.758298, 277188.899908, 144700.690202, 143058.036782, 550636.58284, 361127.967637, 167467.44071, 124540.462381, 491350.015719, 279650.202372, 396186.436754, 270906.582852, 27397.621216, 584827.354294, 403978.597309, 379098.76153, 68708.120797, 371096.721547, 295481.138781, 400436.648204, 271121, 231883.616698, 177537.385478, 168943.484771, 213001.300494, 178354.006181, 185813.844142, 156112.525783, 168763.97704, 114106.819046, 129895.51704, 204254.88706, 238582.627937, 182898, 120948, 144142, 216493.991574, 174017.797069, 45128.941671, 63178.82471, 295609.497603]
	assert test.abundance == [0.96751926368479724, 1.1011219779976515, 0.95869732131068996, 0.83841496955525441, 1.0017894116673542, 0.8583584525432818, 1.3290421773731256, 0.86540366499758392, 0.88340720428155772, 0.83247683583437782, 0.83191124712788844, 0.89723948121373331, 0.76141822785592739, 1.4859935911212121, 1.1183751720318926, 0.92032966754102863, 1.185648826794417, 1.1322030673859678, 1.059858466234983, 0.89557776771907016, 0.88131025402889873, 0.8138127736517341, 0.812672833082554, 0.91525726062653445, 1.1391332634151285, 0.90748324568149441, 0.89704559638278059, 1.0670778464187851, 0.84331065281968998, 1.0542044048276304, 1.0943790944322926, 0.92036398990281676, 0.90545640067844535, 0.89542112630197268, 1.1547736715768302, 0.92708679123521442, 0.94038926234872233, 0.71064450082584485, 1.6124959581219982, 0.84517501430150743, 0.9116577942168681, 0.89250336041846245, 0.90819415672832127, 0.9172727865528234, 0.9295265999742478, 1.0764620913158061, 0.90654449257343472, 0.91181480076547394, 1.1513805044694017, 0.85557907150144974, 0.90624691039410044, 1.3030276527951692, 0.8661788391898867, 0.77226007773442429, 0.85995809368151954, 0.90965869920845654, 1.0878903423967703, 1.0485214980311153, 0.99868944516115943, 1.9244880524347892, 1.0543924475544491, 0.98037481383204095, 0.91505096132429642, 0.85891965967167061, 1.0428283675523653, 1.0248701045754314, 0.93675656897179305, 1.4130461578498827, 1.038612559156544, 1.8521416256262624, 0.86365030349431571, 0.14150518252254451, 0.98711222042477387, 1.2584268390458555, 1.1848203434018898, 0.87606696556848007, 1.1511899058220243, 0.92056152604885344, 0.9467922084797743, 0.97285712120588763, 1.1156545771629109, 0.86469165855623176, 0.82888978389599655, 1.0683601882762357, 0.89429213967804411, 0.91254360325621187, 1.0046593453232657, 1.1297168869453695, 0.84332306729097517, 0.99159895639981754, 1.1630300252444479, 1.3084954971332452, 0.85790678486740857, 0.87212281501489752, 1.0227819174789734, 1.3120551642084974, 0.82964305019779638, 0.92059219709555795, 1.3447698519653315, 0.89476060340330277]
	assert np.sum(test.abundance) == 100

def test_duplicates():
	# i100 express data with duplicates
	test,temp1,temp2,temp3,temp4 = mc.process_input('test_M_compare_metagenome_results_5.xprs',[3477999.0, 3275944.0, 4929566.0, 7068604.0, 5227293.0, 5432653.0, 5427084.0, 5843240.0, 4303871.0, 4202352.0, 4214547.0, 5313031.0, 6293400.0, 5339179.0, 986916.0, 422435.0, 8676565.0, 7040404.0, 2099415.0, 791654.0, 1038863.0, 1181357.0, 1230230.0, 2364842.0, 4751080.0, 6000632.0, 4107014.0, 2547720.0, 3843301.0, 3219507.0, 2369219.0, 2032675.0, 5460382.0, 4433218.0, 4067869.0, 5497655.0, 5249294.0, 4639637.0, 4646332.0, 1892616.0, 3814128.0, 1830138.0, 2012879.0, 3179362.0, 6785432.0, 3705021.0, 2839318.0, 1297538.0, 1856951.0, 2133980.0, 2598353.0, 2365589.0, 1719017.0, 3876236.0, 2814130.0, 1772694.0, 4829781.0, 4345492.0, 6660145.0, 6048425.0, 4424435.0, 2153922.0, 2272360.0, 9059196.0, 5205782.0, 2410873.0, 1864731.0, 5774330.0, 4567418.0, 3101098.0, 4559598.0, 3364647.0, 9702740.0, 5505494.0, 5476069.0, 1111523.0, 4858887.0, 4799110.0, 6691696.0, 4292505.0, 2936937.0, 2902619.0, 2880168.0, 2820462.0, 2821361.0, 2878897.0, 2160267.0, 2038615.0, 1900521.0, 1838554.0, 2696255.0, 2796473.0, 2936195.0, 1915238.0, 2197216.0, 2909809.0, 2843201.0, 751719.0, 703005.0, 4829858.0])
	assert test.species == ['acinetobacter_baumannii_sdf', 'alkalilimnicola_ehrlichii_mlhe1', 'alkaliphilus_metalliredigens_qymf', 'anabaena_variabilis_atcc_29413', 'bacillus_anthracis_str_ames', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_14579', 'bacillus_cereus_e33l', 'bacillus_clausii_ksmk16', 'bacillus_halodurans_c125', 'bacillus_subtilis_subsp_subtilis_str_168', 'bacillus_thuringiensis_str_al_hakam', 'bacteroides_thetaiotaomicron_vpi5482', 'bordetella_bronchiseptica_rb50', 'borrelia_garinii_pbi', 'buchnera_aphidicola_bcc', 'burkholderia_phymatum_stm815', 'burkholderia_pseudomallei_668', 'campylobacter_concisus_13826', 'candidatus_blochmannia_pennsylvanicus_str_bpen', 'chlamydia_trachomatis_l2buch1proctitis', 'chlamydophila_caviae_gpic', 'chlamydophila_pneumoniae_cwl029', 'chlorobium_luteolum_dsm_273', 'chromobacterium_violaceum_atcc_12472', 'clostridium_beijerinckii_ncimb_8052', 'clostridium_botulinum_b1_str_okra', 'clostridium_novyi_nt', 'clostridium_thermocellum_atcc_27405', 'corynebacterium_efficiens_ys314', 'corynebacterium_urealyticum_dsm_7109', 'coxiella_burnetii_rsa_493', 'cyanothece_sp_atcc_51142', 'cytophaga_hutchinsonii_atcc_33406', 'erwinia_tasmaniensis', 'escherichia_coli_apec_o1', 'escherichia_coli_e24377a', 'escherichia_coli_str_k12_substr_mg1655', 'escherichia_coli_str_k12_substr_w3110', 'francisella_tularensis_subsp_tularensis_fsc198', 'geobacter_sulfurreducens_pca', 'haemophilus_influenzae_rd_kw20', 'haemophilus_somnus_129pt', 'haloquadratum_walsbyi_dsm_16790', 'herpetosiphon_aurantiacus_dsm_785', 'hyphomonas_neptunium_atcc_15444', 'idiomarina_loihiensis_l2tr', 'ignicoccus_hospitalis_kin4i', 'lactobacillus_delbrueckii_subsp_bulgaricus_atcc_baa365', 'lactobacillus_salivarius_ucc118', 'lactococcus_lactis_subsp_cremoris_sk11', 'lactococcus_lactis_subsp_lactis_il1403', 'lawsonia_intracellularis_phemn100', 'leptospira_borgpetersenii_serovar_hardjobovis_jb197', 'listeria_welshimeri_serovar_6b_str_slcc5334', 'methanococcus_maripaludis_c7', 'mycobacterium_avium_subsp_paratuberculosis_k10', 'mycobacterium_bovis_af212297', 'mycobacterium_marinum_m', 'mycobacterium_sp_jls', 'mycobacterium_tuberculosis_f11', 'neisseria_gonorrhoeae_fa_1090', 'neisseria_meningitidis_mc58', 'nostoc_punctiforme_pcc_73102', 'ochrobactrum_anthropi_atcc_49188', 'prochlorococcus_marinus_str_mit_9313', 'prochlorococcus_marinus_str_natl1a', 'pseudomonas_putida_w619', 'pseudomonas_stutzeri_a1501', 'psychrobacter_cryohalolentis_k5', 'psychromonas_ingrahamii_37', 'ralstonia_eutropha_h16', 'rhodococcus_jostii_rha1', 'rhodopseudomonas_palustris_bisa53', 'rhodopseudomonas_palustris_cga009', 'rickettsia_prowazekii_str_madrid_e', 'salmonella_enterica_subsp_enterica_serovar_paratyphi_b_str_spb7', 'shewanella_sp_mr7', 'sinorhizobium_meliloti_1021', "sodalis_glossinidius_str_morsitans", 'staphylococcus_aureus_subsp_aureus_jh1', 'staphylococcus_aureus_subsp_aureus_mrsa252', 'staphylococcus_aureus_subsp_aureus_mu3', 'staphylococcus_aureus_subsp_aureus_mw2', 'staphylococcus_aureus_subsp_aureus_nctc_8325', 'staphylococcus_aureus_subsp_aureus_str_newman', 'streptococcus_agalactiae_2603vr', 'streptococcus_pneumoniae_r6', 'streptococcus_pyogenes_mgas315', 'streptococcus_pyogenes_mgas5005', 'synechococcus_elongatus_pcc_6301', 'synechococcus_elongatus_pcc_7942', 'syntrophomonas_wolfei_subsp_wolfei_str_goettingen', 'thermosipho_melanesiensis_bi429', 'thermus_thermophilus_hb8', 'thiobacillus_denitrificans_atcc_25259', 'treponema_denticola_atcc_35405', 'ureaplasma_parvum_serovar_3_str_atcc_700970', 'wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis', 'yersinia_pestis_co92']
	assert test.counts == [234629, 213760.310134, 346706, 419783.882839, 383225.415617, 341431.949696, 527556.388114, 370053.769894, 268292.464229, 252582, 255483.375161, 348831.143398, 374089.490633, 434216.50783, 76330.818648, 25003.805463, 622392.549366, 433035.731062, 149229, 49913.184351, 68712.666882, 71288.170978, 74878.690298, 149806, 314425.789323, 397185.090472, 268466.222044, 198497.61575, 245521, 218375.770032, 161110.797489, 128066, 351901, 290454, 307753.334438, 344533.199106, 332812.370121, 219143.196593, 502007.164229, 113850, 230958.696804, 112050.986698, 129028.702287, 212194, 404085, 250388.424192, 177646.663253, 83196, 146165, 130504.949106, 167933.669028, 218923.755127, 109296.362415, 230036, 172045.6361, 114988.199135, 293558.49435, 270674.57774, 396721.935148, 673559.758298, 277188.899908, 144700.690202, 143058.036782, 550636.58284, 361127.967637, 167467.44071, 124540.462381, 491350.015719, 279650.202372, 396186.436754, 270906.582852, 27397.621216, 584827.354294, 403978.597309, 379098.76153, 68708.120797, 371096.721547, 295481.138781, 400436.648204, 271121, 231883.616698, 177537.385478, 168943.484771, 213001.300494, 178354.006181, 185813.844142, 156112.525783, 168763.97704, 114106.819046, 129895.51704, 204254.88706, 238582.627937, 182898, 120948, 144142, 216493.991574, 174017.797069, 45128.941671, 442251.77297, 295609.497603]
	assert test.abundance == [0.8952823415685022, 1.0189100101839847, 0.8871190630454543, 0.7758172320939466, 0.9269938118030817, 0.794271694778805, 1.2298132319043449, 0.8007908975892103, 0.8174502566445434, 0.7703224513058865, 0.7697990905827293, 0.8302497881328349, 0.7045692210319403, 1.3750463393855532, 1.03487504626573, 0.8516160149959815, 1.0971259154962625, 1.0476705233132997, 0.9807273146875398, 0.828712141489137, 0.8155098688891583, 0.7530518853117595, 0.7519970549840019, 0.8469223241205138, 1.054083297054761, 0.8397287326700685, 0.8300703791309004, 0.9874076815166319, 0.7803473938603065, 0.9754953968062687, 1.0126705637833755, 0.8516477747816347, 0.8378532159662302, 0.8285671952333368, 1.0685559610808668, 0.8578686383289362, 0.8701779203599642, 0.6575863619490835, 1.4921037868115494, 0.7820725583873824, 0.8435916010676515, 0.8258672755827564, 0.8403865656771615, 0.8487873668524877, 0.8601262860707931, 0.9960912799322954, 0.838860068745448, 0.8437368851935118, 1.0654161346119837, 0.7916998278810177, 0.8385847046464339, 1.2057410037295353, 0.8015081957268878, 0.7146015967276838, 0.7957519035122792, 0.841741762488384, 1.0066662749446238, 0.9702367871902465, 0.9241252949924912, 1.7808019277492526, 0.9756693998872409, 0.9071780706459185, 0.8467314275365344, 0.7947910010612405, 0.9649687172125403, 0.9483512540446645, 0.8668164511316293, 1.307545307290502, 0.9610676694981614, 1.713857029773192, 0.7991684455604169, 0.1309401227530852, 0.9134124489956256, 1.164470175883409, 1.0963592883298043, 0.8106580548255449, 1.0652397664405904, 0.8518305624841704, 0.8761028097345831, 0.9002216639776918, 1.0323575764476252, 0.8001320509719367, 0.767003215835069, 0.9885942811678444, 0.8275225010073832, 0.8444112738335516, 0.9296494704757835, 1.045369966073805, 0.7803588814423514, 0.9175641962946286, 1.0761958788807573, 1.210800607880135, 0.7938537495144115, 0.8070083824359102, 0.9464189751707225, 1.2140945030964418, 0.7677002417691383, 0.8518589435692223, 8.710566528123769, 0.8279559882945431]
	assert np.sum(test.abundance) == 100

def test_calc_error_simLC_truth():
	# simLC original data, should be no error
	truth,t1,t2,t3,t4 = mc.dataset_truth('simLC')
	test_diff,test_ab = mc.calc_error(truth,truth)
	assert np.mean(abs(test_diff)) == 0

def test_calc_error_i100_truth():
	# i100 original data, should be no error
	truth,t1,t2,t3,t4 = mc.dataset_truth('i100')
	test_diff,test_ab = mc.calc_error(truth,truth)
	assert np.mean(abs(test_diff)) == 0

def test_calc_error_i400_truth():
	# i400 original data, should be no error
	truth,t1,t2,t3,t4 = mc.dataset_truth('i400')
	test_diff,test_ab = mc.calc_error(truth,truth)
	assert np.mean(abs(test_diff)) == 0

def test_calc_error_simLC_error():
	# last two entries have error, both positive and negative diffs
	truth,t1,t2,t3,t4 = mc.dataset_truth('simLC')
	test = mc.Dataset(truth.species,truth.abundance)
	test.abundance[-1] = test.abundance[-1]-.5
	test.abundance[-2] = test.abundance[-2]+.5
	test_diff,test_ab = mc.calc_error(truth,test)
	assert [round(x,5) for x in test_diff] == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.92032, -48.07692]
	assert np.mean(abs(test_diff)) == 0.60174550267276705

def test_calc_error_i100_error():
	# last two entries have error, both positive and negative diffs
	truth,t1,t2,t3,t4 = mc.dataset_truth('i100')
	test = mc.Dataset(truth.species,truth.abundance)
	test.abundance[-1] = test.abundance[-1]+.4
	test.abundance[-2] = test.abundance[-2]-.2
	test_diff,test_ab = mc.calc_error(truth,test)
	assert [round(x,5) for x in test_diff] == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.04268, 43.64012]

def test_calc_error_i400_error():
	# last two entries have error, both positive and negative diffs
	truth,t1,t2,t3,t4 = mc.dataset_truth('i400')
	test = mc.Dataset(truth.species,truth.abundance)
	test.abundance[-1] = test.abundance[-1]-.11
	test.abundance[-2] = test.abundance[-2]+.22
	test_diff,test_ab = mc.calc_error(truth,test)
	assert [round(x,5) for x in test_diff] == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 98.29907, -49.15978]
	assert round(np.mean(abs(test_diff)),5) ==  0.36865

def test_calc_error_i100_extra():
	# has extra species in it
	truth,t1,t2,t3,t4 = mc.dataset_truth('i100')
	test = mc.Dataset(truth.species,truth.abundance)
	test.abundance = [a/2 for a in test.abundance]
	test_diff,test_ab = mc.calc_error(truth,test)
	assert np.mean(abs(test_diff)) == 50

'''
def test_collapse_strains():
	test_species = ['acinetobacter_baumannii_sdf', 'acinetobacter_baumannii_sda', 'acinetobacter_baumannii_sdb', 'acinetobacter_baumannii_sdc', 'acinetobacter_c_1', 'acinetobacter_c_2', 'acinetobacter_c_3', 'bacillus_cereus_atcc_10987', 'bacillus_cereus_atcc_200', 'bacillus_cereus_atcc']
	test_abundance = [1,1,1,1,1,1,1,1,1,1]
	test = mc.Dataset(test_species,test_abundance)

	test_species_alone,test_species_ab,test_genus_alone,test_genus_ab = mc.collapse_strains(test.species,test.abundance)
	assert test_species_alone == ['acinetobacter_baumannii', 'acinetobacter_c', 'bacillus_cereus']
	assert isinstance(test_species_ab, np.ndarray)
	assert list(test_species_ab) == [4,3,3]
	assert test_genus_alone == ['acinetobacter','bacillus']
	assert isinstance(test_genus_ab, np.ndarray)
	assert list(test_genus_ab) == [7,3]
'''
