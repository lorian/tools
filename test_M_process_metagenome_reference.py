# test functions for M_process_metagenome_reference.py

import M_process_metagenome_reference as pm
import numpy as np

def test_is_duplicate():
	i100_lines = ['>acinetobacter_baumannii_sdf gi|169632029|ref|NC_010400.1| Acinetobacter baumannii SDF chromosome, complete genome', '>alkalilimnicola_ehrlichii_mlhe-1 gi|114319166|ref|NC_008340.1| Alkalilimnicola ehrlichii MLHE-1 chromosome, complete genome', '>alkaliphilus_metalliredigens_qymf gi|150387853|ref|NC_009633.1| Alkaliphilus metalliredigens QYMF chromosome, complete genome', '>anabaena_variabilis_atcc_29413 gi|75906225|ref|NC_007413.1| Anabaena variabilis ATCC 29413 chromosome, complete genome', '>bacillus_anthracis_str._ames gi|30260195|ref|NC_003997.3| Bacillus anthracis str. Ames chromosome, complete genome', '>bacillus_cereus_atcc_10987 gi|42779081|ref|NC_003909.8| Bacillus cereus ATCC 10987, complete genome', '>bacillus_cereus_atcc_14579 gi|30018278|ref|NC_004722.1| Bacillus cereus ATCC 14579, complete genome', '>bacillus_cereus_e33l gi|52140164|ref|NC_006274.1| Bacillus cereus E33L chromosome, complete genome', '>bacillus_clausii_ksm-k16 gi|56961782|ref|NC_006582.1| Bacillus clausii KSM-K16, complete genome', '>bacillus_halodurans_c-125 gi|57596592|ref|NC_002570.2| Bacillus halodurans C-125 chromosome, complete genome', '>bacillus_subtilis_subsp._subtilis_str._168 gi|223666304|ref|NZ_CM000487.1| Bacillus subtilis subsp. subtilis str. 168 chromosome, whole genome shotgun sequence', '>bacillus_thuringiensis_str._al_hakam gi|118415003|gb|CP000485.1| Bacillus thuringiensis str. Al Hakam, complete genome', '>bacteroides_thetaiotaomicron_vpi-5482 gi|29345410|ref|NC_004663.1| Bacteroides thetaiotaomicron VPI-5482 chromosome, complete genome', '>bordetella_bronchiseptica_rb50 gi|33598993|ref|NC_002927.3| Bordetella bronchiseptica RB50 chromosome, complete genome', '>borrelia_garinii_pbi gi|51598263|ref|NC_006156.1| Borrelia garinii PBi chromosome linear, complete sequence', '>buchnera_aphidicola_bcc gi|116256804|gb|CP000263.1| Buchnera aphidicola BCc, complete genome', '>burkholderia_phymatum_stm815 gi|186471973|ref|NC_010623.1| Burkholderia phymatum STM815 chromosome 2, complete sequence', '>burkholderia_pseudomallei_668 gi|126442307|ref|NC_009075.1| Burkholderia pseudomallei 668 chromosome chromosome II, complete sequence', '>campylobacter_concisus_13826 gi|157163852|ref|NC_009802.1| Campylobacter concisus 13826, complete genome', '>candidatus_blochmannia_pennsylvanicus_str._bpen gi|71891793|ref|NC_007292.1| Candidatus Blochmannia pennsylvanicus str. BPEN chromosome, complete genome', '>chlamydia_trachomatis_l2b/uch-1/proctitis gi|352951305|ref|NC_010280.2| Chlamydia trachomatis L2b/UCH-1/proctitis chromosome, complete genome', '>chlamydophila_caviae_gpic gi|29839769|ref|NC_003361.3| Chlamydophila caviae GPIC chromosome, complete genome', '>chlamydophila_pneumoniae_cwl029 gi|15617929|ref|NC_000922.1| Chlamydophila pneumoniae CWL029 chromosome, complete genome', '>chlorobium_luteolum_dsm_273 gi|78185892|ref|NC_007512.1| Chlorobium luteolum DSM 273 chromosome, complete genome', '>chromobacterium_violaceum_atcc_12472 gi|34495455|ref|NC_005085.1| Chromobacterium violaceum ATCC 12472 chromosome, complete genome', '>clostridium_beijerinckii_ncimb_8052 gi|150014892|ref|NC_009617.1| Clostridium beijerinckii NCIMB 8052 chromosome, complete genome', '>clostridium_botulinum_b1_str._okra gi|170754211|ref|NC_010516.1| Clostridium botulinum B1 str. Okra chromosome, complete genome', '>clostridium_novyi_nt gi|118442852|ref|NC_008593.1| Clostridium novyi NT chromosome, complete genome', '>clostridium_thermocellum_atcc_27405 gi|125972525|ref|NC_009012.1| Clostridium thermocellum ATCC 27405 chromosome, complete genome', '>corynebacterium_efficiens_ys-314 gi|25026556|ref|NC_004369.1| Corynebacterium efficiens YS-314 chromosome, complete genome', '>corynebacterium_urealyticum_dsm_7109 gi|172039680|ref|NC_010545.1| Corynebacterium urealyticum DSM 7109 chromosome, complete genome', '>coxiella_burnetii_rsa_493 gi|77358712|ref|NC_002971.3| Coxiella burnetii RSA 493 chromosome, complete genome', '>cyanothece_sp._atcc_51142 gi|172054853|ref|NC_010547.1| Cyanothece sp. ATCC 51142 chromosome linear, complete sequence', '>cytophaga_hutchinsonii_atcc_33406 gi|110636427|ref|NC_008255.1| Cytophaga hutchinsonii ATCC 33406 chromosome, complete genome', '>erwinia_tasmaniensis gi|188532165|ref|NC_010694.1| Erwinia tasmaniensis Et1/99 chromosome, complete genome', '>escherichia_coli_apec_o1 gi|117622295|ref|NC_008563.1| Escherichia coli APEC O1 chromosome, complete genome', '>escherichia_coli_e24377a gi|157154711|ref|NC_009801.1| Escherichia coli E24377A chromosome, complete genome', '>escherichia_coli_str._k-12_substr._mg1655 gi|452215505|ref|NZ_CM000960.1| Escherichia coli str. K-12 substr. MG1655star strain K-12 MG1655star chromosome, whole genome shotgun sequence', '>escherichia_coli_str._k-12_substr._w3110 gi|388476123|ref|NC_007779.1| Escherichia coli str. K-12 substr. W3110, complete genome', '>francisella_tularensis_subsp._tularensis_fsc198 gi|110669657|ref|NC_008245.1| Francisella tularensis subsp. tularensis FSC198 chromosome, complete genome', '>geobacter_sulfurreducens_pca gi|399107616|gb|AE017180.2| Geobacter sulfurreducens PCA, complete genome', '>haemophilus_influenzae_rd_kw20 gi|16271976|ref|NC_000907.1| Haemophilus influenzae Rd KW20 chromosome, complete genome', '>haemophilus_somnus_129pt gi|113460149|ref|NC_008309.1| Haemophilus somnus 129PT chromosome, complete genome', '>haloquadratum_walsbyi_dsm_16790 gi|110666976|ref|NC_008212.1| Haloquadratum walsbyi DSM 16790, complete genome', '>herpetosiphon_aurantiacus_dsm_785 gi|159889572|gb|CP000875.1| Herpetosiphon aurantiacus DSM 785, complete genome', '>hyphomonas_neptunium_atcc_15444 gi|114797051|ref|NC_008358.1| Hyphomonas neptunium ATCC 15444 chromosome, complete genome', '>idiomarina_loihiensis_l2tr gi|56459112|ref|NC_006512.1| Idiomarina loihiensis L2TR chromosome, complete genome', '>ignicoccus_hospitalis_kin4/i gi|156936795|ref|NC_009776.1| Ignicoccus hospitalis KIN4/I chromosome, complete genome', '>lactobacillus_delbrueckii_subsp._bulgaricus_atcc_baa-365 gi|116513228|ref|NC_008529.1| Lactobacillus delbrueckii subsp. bulgaricus ATCC BAA-365 chromosome, complete genome', '>lactobacillus_salivarius_ucc118 gi|90960990|ref|NC_007929.1| Lactobacillus salivarius UCC118 chromosome, complete genome', '>lactococcus_lactis_subsp._cremoris_sk11 gi|116510843|ref|NC_008527.1| Lactococcus lactis subsp. cremoris SK11, complete genome', '>lactococcus_lactis_subsp._lactis_il1403 gi|15671982|ref|NC_002662.1| Lactococcus lactis subsp. lactis Il1403 chromosome, complete genome', '>lawsonia_intracellularis_phe/mn1-00 gi|94986445|ref|NC_008011.1| Lawsonia intracellularis PHE/MN1-00 chromosome, complete genome', '>leptospira_borgpetersenii_serovar_hardjo-bovis_jb197 gi|116127312|gb|CP000351.1| Leptospira borgpetersenii serovar Hardjo-bovis JB197 chromosome 2, complete sequence', '>listeria_welshimeri_serovar_6b_str._slcc5334 gi|116871422|ref|NC_008555.1| Listeria welshimeri serovar 6b str. SLCC5334 chromosome, complete genome', '>methanococcus_maripaludis_c7 gi|150401930|ref|NC_009637.1| Methanococcus maripaludis C7 chromosome, complete genome', '>mycobacterium_avium_subsp._paratuberculosis_k-10 gi|41406098|ref|NC_002944.2| Mycobacterium avium subsp. paratuberculosis K-10, complete genome', '>mycobacterium_bovis_af2122/97 gi|31791177|ref|NC_002945.3| Mycobacterium bovis AF2122/97 chromosome, complete genome', '>mycobacterium_marinum_m gi|183980035|ref|NC_010612.1| Mycobacterium marinum M chromosome, complete genome', '>mycobacterium_sp._jls gi|126432613|ref|NC_009077.1| Mycobacterium sp. JLS chromosome, complete genome', '>mycobacterium_tuberculosis_f11 gi|148821191|ref|NC_009565.1| Mycobacterium tuberculosis F11 chromosome, complete genome', '>neisseria_gonorrhoeae_fa_1090 gi|59800473|ref|NC_002946.2| Neisseria gonorrhoeae FA 1090 chromosome, complete genome', '>neisseria_meningitidis_mc58 gi|77358697|ref|NC_003112.2| Neisseria meningitidis MC58 chromosome, complete genome', '>nostoc_punctiforme_pcc_73102 gi|186463002|gb|CP001037.1| Nostoc punctiforme PCC 73102, complete genome', '>ochrobactrum_anthropi_atcc_49188 gi|153010078|ref|NC_009668.1| Ochrobactrum anthropi ATCC 49188 chromosome 2, complete sequence', '>prochlorococcus_marinus_str._mit_9313 gi|33862273|ref|NC_005071.1| Prochlorococcus marinus str. MIT 9313 chromosome, complete genome', '>prochlorococcus_marinus_str._natl1a gi|124024712|ref|NC_008819.1| Prochlorococcus marinus str. NATL1A, complete genome', '>pseudomonas_putida_w619 gi|170719187|ref|NC_010501.1| Pseudomonas putida W619 chromosome, complete genome', '>pseudomonas_stutzeri_a1501 gi|146280397|ref|NC_009434.1| Pseudomonas stutzeri A1501 chromosome, complete genome', '>psychrobacter_cryohalolentis_k5 gi|93004831|ref|NC_007969.1| Psychrobacter cryohalolentis K5 chromosome, complete genome', '>psychromonas_ingrahamii_37 gi|119943794|ref|NC_008709.1| Psychromonas ingrahamii 37 chromosome, complete genome', '>ralstonia_eutropha_h16 gi|116693960|ref|NC_008314.1| Ralstonia eutropha H16 chromosome 2, complete sequence', '>rhodococcus_jostii_rha1 gi|111017022|ref|NC_008268.1| Rhodococcus jostii RHA1 chromosome, complete genome', '>rhodopseudomonas_palustris_bisa53 gi|115522030|ref|NC_008435.1| Rhodopseudomonas palustris BisA53 chromosome, complete genome', '>rhodopseudomonas_palustris_cga009 gi|39933080|ref|NC_005296.1| Rhodopseudomonas palustris CGA009 chromosome, complete genome', '>rickettsia_prowazekii_str._madrid_e gi|15603881|ref|NC_000963.1| Rickettsia prowazekii str. Madrid E chromosome, complete genome', '>salmonella_enterica_subsp._enterica_serovar_paratyphi_b_str._spb7 gi|161612313|ref|NC_010102.1| Salmonella enterica subsp. enterica serovar Paratyphi B str. SPB7 chromosome, complete genome', '>shewanella_sp._mr-7 gi|114045513|ref|NC_008322.1| Shewanella sp. MR-7 chromosome, complete genome', '>sinorhizobium_meliloti_1021 gi|15963753|ref|NC_003047.1| Sinorhizobium meliloti 1021 chromosome, complete genome', ">sodalis_glossinidius_str._'morsitans' gi|85057978|ref|NC_007712.1| Sodalis glossinidius str. 'morsitans' chromosome, complete genome", '>staphylococcus_aureus_subsp._aureus_jh1 gi|150392480|ref|NC_009632.1| Staphylococcus aureus subsp. aureus JH1 chromosome, complete genome', '>staphylococcus_aureus_subsp._aureus_mrsa252 gi|49482253|ref|NC_002952.2| Staphylococcus aureus subsp. aureus MRSA252 chromosome, complete genome', '>staphylococcus_aureus_subsp._aureus_mu3 gi|156978331|ref|NC_009782.1| Staphylococcus aureus subsp. aureus Mu3, complete genome', '>staphylococcus_aureus_subsp._aureus_mw2 gi|21281729|ref|NC_003923.1| Staphylococcus aureus subsp. aureus MW2, complete genome', '>staphylococcus_aureus_subsp._aureus_nctc_8325 gi|88193823|ref|NC_007795.1| Staphylococcus aureus subsp. aureus NCTC 8325 chromosome, complete genome', '>staphylococcus_aureus_subsp._aureus_str._newman gi|151220212|ref|NC_009641.1| Staphylococcus aureus subsp. aureus str. Newman chromosome, complete genome', '>streptococcus_agalactiae_2603v/r gi|22536185|ref|NC_004116.1| Streptococcus agalactiae 2603V/R chromosome, complete genome', '>streptococcus_pneumoniae_r6 gi|15902044|ref|NC_003098.1| Streptococcus pneumoniae R6, complete genome', '>streptococcus_pyogenes_mgas315 gi|21909536|ref|NC_004070.1| Streptococcus pyogenes MGAS315 chromosome, complete genome', '>streptococcus_pyogenes_mgas5005 gi|71909814|ref|NC_007297.1| Streptococcus pyogenes MGAS5005 chromosome, complete genome', '>synechococcus_elongatus_pcc_6301 gi|56750010|ref|NC_006576.1| Synechococcus elongatus PCC 6301 chromosome, complete genome', '>synechococcus_elongatus_pcc_7942 gi|81298811|ref|NC_007604.1| Synechococcus elongatus PCC 7942 chromosome, complete genome', '>syntrophomonas_wolfei_subsp._wolfei_str._goettingen gi|114565576|ref|NC_008346.1| Syntrophomonas wolfei subsp. wolfei str. Goettingen chromosome, complete genome', '>thermosipho_melanesiensis_bi429 gi|150019913|ref|NC_009616.1| Thermosipho melanesiensis BI429 chromosome, complete genome', '>thermus_thermophilus_hb8 gi|55979969|ref|NC_006461.1| Thermus thermophilus HB8 chromosome, complete genome', '>thiobacillus_denitrificans_atcc_25259 gi|74316018|ref|NC_007404.1| Thiobacillus denitrificans ATCC 25259 chromosome, complete genome', '>treponema_denticola_atcc_35405 gi|42516522|ref|NC_002967.9| Treponema denticola ATCC 35405 chromosome, complete genome', '>ureaplasma_parvum_serovar_3_str._atcc_700970 gi|13357558|ref|NC_002162.1| Ureaplasma parvum serovar 3 str. ATCC 700970 chromosome, complete genome', '>wigglesworthia_glossinidia_endosymbiont_of_glossina_brevipalpis gi|32490749|ref|NC_004344.2| Wigglesworthia glossinidia endosymbiont of Glossina brevipalpis chromosome, complete genome', '>yersinia_pestis_co92 gi|16120353|ref|NC_003143.1| Yersinia pestis CO92 chromosome, complete genome']
	for s in i100_lines:
		assert pm.is_duplicate(s)

	martin_duplicate_lines = [">bacillus_cereus_atcc_10987 gi|42779081|ref|NC_003909.8| Bacillus cereus ATCC 10987, complete genome", ">bacillus_cereus_atcc_14579 gi|30018278|ref|NC_004722.1| Bacillus cereus ATCC 14579, complete genome", ">bacillus_cereus_e33l gi|52140164|ref|NC_006274.1| Bacillus cereus E33L chromosome, complete genome", ">burkholderia_phymatum_stm815 gi|186471973|ref|NC_010623.1| Burkholderia phymatum STM815 chromosome 2, complete sequence", ">burkholderia_pseudomallei_668 gi|126442307|ref|NC_009075.1| Burkholderia pseudomallei 668 chromosome chromosome II, complete sequence", ">chlamydophila_caviae_gpic gi|29839769|ref|NC_003361.3| Chlamydophila caviae GPIC chromosome, complete genome", ">chlamydophila_pneumoniae_cwl029 gi|15617929|ref|NC_000922.1| Chlamydophila pneumoniae CWL029 chromosome, complete genome", ">clostridium_beijerinckii_ncimb_8052 gi|150014892|ref|NC_009617.1| Clostridium beijerinckii NCIMB 8052 chromosome, complete genome", ">clostridium_botulinum_b1_str._okra gi|170754211|ref|NC_010516.1| Clostridium botulinum B1 str. Okra chromosome, complete genome", ">clostridium_novyi_nt gi|118442852|ref|NC_008593.1| Clostridium novyi NT chromosome, complete genome", ">clostridium_thermocellum_atcc_27405 gi|125972525|ref|NC_009012.1| Clostridium thermocellum ATCC 27405 chromosome, complete genome", ">corynebacterium_efficiens_ys-314 gi|25026556|ref|NC_004369.1| Corynebacterium efficiens YS-314 chromosome, complete genome", ">corynebacterium_urealyticum_dsm_7109 gi|172039680|ref|NC_010545.1| Corynebacterium urealyticum DSM 7109 chromosome, complete genome", ">escherichia_coli_apec_o1 gi|117622295|ref|NC_008563.1| Escherichia coli APEC O1 chromosome, complete genome", ">escherichia_coli_e24377a gi|157154711|ref|NC_009801.1| Escherichia coli E24377A chromosome, complete genome", ">escherichia_coli_str._k-12_substr._mg1655 gi|452215505|ref|NZ_CM000960.1| Escherichia coli str. K-12 substr. MG1655star strain K-12 MG1655star chromosome, whole genome shotgun sequence", ">escherichia_coli_str._k-12_substr._w3110 gi|388476123|ref|NC_007779.1| Escherichia coli str. K-12 substr. W3110, complete genome", ">haemophilus_influenzae_rd_kw20 gi|16271976|ref|NC_000907.1| Haemophilus influenzae Rd KW20 chromosome, complete genome", ">haemophilus_somnus_129pt gi|113460149|ref|NC_008309.1| Haemophilus somnus 129PT chromosome, complete genome", ">lactobacillus_delbrueckii_subsp._bulgaricus_atcc_baa-365 gi|116513228|ref|NC_008529.1| Lactobacillus delbrueckii subsp. bulgaricus ATCC BAA-365 chromosome, complete genome", ">lactobacillus_salivarius_ucc118 gi|90960990|ref|NC_007929.1| Lactobacillus salivarius UCC118 chromosome, complete genome", ">lactococcus_lactis_subsp._cremoris_sk11 gi|116510843|ref|NC_008527.1| Lactococcus lactis subsp. cremoris SK11, complete genome", ">lactococcus_lactis_subsp._lactis_il1403 gi|15671982|ref|NC_002662.1| Lactococcus lactis subsp. lactis Il1403 chromosome, complete genome", ">mycobacterium_avium_subsp._paratuberculosis_k-10 gi|41406098|ref|NC_002944.2| Mycobacterium avium subsp. paratuberculosis K-10, complete genome", ">mycobacterium_bovis_af2122/97 gi|31791177|ref|NC_002945.3| Mycobacterium bovis AF2122/97 chromosome, complete genome", ">mycobacterium_marinum_m gi|183980035|ref|NC_010612.1| Mycobacterium marinum M chromosome, complete genome", ">mycobacterium_sp._jls gi|126432613|ref|NC_009077.1| Mycobacterium sp. JLS chromosome, complete genome", ">mycobacterium_tuberculosis_f11 gi|148821191|ref|NC_009565.1| Mycobacterium tuberculosis F11 chromosome, complete genome", ">prochlorococcus_marinus_str._mit_9313 gi|33862273|ref|NC_005071.1| Prochlorococcus marinus str. MIT 9313 chromosome, complete genome", ">prochlorococcus_marinus_str._natl1a gi|124024712|ref|NC_008819.1| Prochlorococcus marinus str. NATL1A, complete genome", ">pseudomonas_putida_w619 gi|170719187|ref|NC_010501.1| Pseudomonas putida W619 chromosome, complete genome", ">pseudomonas_stutzeri_a1501 gi|146280397|ref|NC_009434.1| Pseudomonas stutzeri A1501 chromosome, complete genome", ">rhodopseudomonas_palustris_bisa53 gi|115522030|ref|NC_008435.1| Rhodopseudomonas palustris BisA53 chromosome, complete genome", ">rhodopseudomonas_palustris_cga009 gi|39933080|ref|NC_005296.1| Rhodopseudomonas palustris CGA009 chromosome, complete genome", ">staphylococcus_aureus_subsp._aureus_jh1 gi|150392480|ref|NC_009632.1| Staphylococcus aureus subsp. aureus JH1 chromosome, complete genome", ">staphylococcus_aureus_subsp._aureus_mrsa252 gi|49482253|ref|NC_002952.2| Staphylococcus aureus subsp. aureus MRSA252 chromosome, complete genome", ">staphylococcus_aureus_subsp._aureus_mu3 gi|156978331|ref|NC_009782.1| Staphylococcus aureus subsp. aureus Mu3, complete genome", ">staphylococcus_aureus_subsp._aureus_mw2 gi|21281729|ref|NC_003923.1| Staphylococcus aureus subsp. aureus MW2, complete genome", ">staphylococcus_aureus_subsp._aureus_nctc_8325 gi|88193823|ref|NC_007795.1| Staphylococcus aureus subsp. aureus NCTC 8325 chromosome, complete genome", ">staphylococcus_aureus_subsp._aureus_str._newman gi|151220212|ref|NC_009641.1| Staphylococcus aureus subsp. aureus str. Newman chromosome, complete genome", ">streptococcus_agalactiae_2603v/r gi|22536185|ref|NC_004116.1| Streptococcus agalactiae 2603V/R chromosome, complete genome", ">streptococcus_pneumoniae_r6 gi|15902044|ref|NC_003098.1| Streptococcus pneumoniae R6, complete genome", ">streptococcus_pyogenes_mgas315 gi|21909536|ref|NC_004070.1| Streptococcus pyogenes MGAS315 chromosome, complete genome", ">streptococcus_pyogenes_mgas5005 gi|71909814|ref|NC_007297.1| Streptococcus pyogenes MGAS5005 chromosome, complete genome", ">synechococcus_elongatus_pcc_6301 gi|56750010|ref|NC_006576.1| Synechococcus elongatus PCC 6301 chromosome, complete genome", ">synechococcus_elongatus_pcc_7942 gi|81298811|ref|NC_007604.1| Synechococcus elongatus PCC 7942 chromosome, complete genome"]
	for s in martin_duplicate_lines:
		assert pm.is_duplicate(s)

def test_find_fragment_size():
	# genome smaller than ideal fragment
	assert pm.find_fragment_size(20,500) == 20
	# genome a multiple of ideal fragment
	assert pm.find_fragment_size(10000,500) == 500
	# genome slightly smaller than multiple
	assert pm.find_fragment_size(9900,500) == 495
	# genome slightly larger than multiple
	assert pm.find_fragment_size(10100,500) == 505

def test_chop_genome():
	bp_500 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
	assert pm.chop_genome(bp_500,'test\n',100) == "test_0\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\ntest_100\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\ntest_200\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\ntest_300\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\ntest_400\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n"

def test_process_file():
	pm.process_file("test_M_process_metagenome_reference_1.fasta",5000000,100)
	test_output = ""
	for line in open('test_M_process_metagenome_reference_1_fragmented_genomes_0.mfa','r'):
		test_output += line
	assert test_output == ">test_file_0\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_101\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_202\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_303\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_404\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n"

	pm.process_file("test_M_process_metagenome_reference_2.fasta",5000000,75,True)
	genome_output = ""
	for line in open('test_M_process_metagenome_reference_2_fragmented_genomes_0.mfa','r'):
		genome_output += line
	assert genome_output == ">test_file_0\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_73\nAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_146\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAA\n>test_file_219\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_292\nAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_365\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_438\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_0\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_73\nAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_146\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAA\n>test_file_second_219\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_292\nAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_365\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_second_438\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_0\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_73\nAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_146\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAA\n>test_file_third_219\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_292\nAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_365\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>test_file_third_438\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n"
	plasmid_output = ""
	for line in open('test_M_process_metagenome_reference_2_fragmented_plasmids_0.mfa','r'):
		plasmid_output += line
	assert plasmid_output == ">test_file_plasmid\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n>acinetobacter_baumannii_sdf_gi|169632029|ref|NC_010400.1|_Acinetobacter_baumannii_SDF_plasmid\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n"
